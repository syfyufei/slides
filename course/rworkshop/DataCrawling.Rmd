---
title: "ç½‘ç»œçˆ¬è™«è¿›é˜¶"
subtitle: "R workshop Lecture6"
author: "Sun Yufei"
institute: "Department of Political Science, Tsinghua University"
date: "`r Sys.Date()`"
output:
  xaringan::moon_reader:
    self_contained: yes
    lib_dir: libs
    css:
      - default
      - zh-CN_custom.css
      - styles.css
    
    mathjax: "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_HTMLorMML"
    nature:
      highlightStyle: github
      highlightLines: true
      highlightSpans: true
      countIncrementalSlides: false
      ratio: 21:9


---

## Outline

- åˆçª¥é—¨å¾„ï¼šçˆ¬è™«åŸºç¡€çŸ¥è¯†

- åˆ©åˆƒå‡ºé˜ï¼šæˆ‘ä»¬çš„çˆ¬è™«å·¥å…·ç®±

- å°è¯•ç‰›åˆ€ï¼šå¦‚ä½•ä½¿ç”¨å…«çˆªé±¼æ¥æŠ“å–ç½‘é¡µæ–°é—»ä¿¡æ¯

- å°è¯•ç‰›åˆ€ï¼šå¦‚ä½•ä½¿ç”¨RæŠ“å–æ”¿åºœç½‘é¡µ


---
class: inverse, center, middle

# åˆçª¥é—¨å¾„ï¼šçˆ¬è™«åŸºç¡€çŸ¥è¯†

---

## ä»€ä¹ˆæ˜¯çˆ¬è™«

åœ¨å¹¿è¢¤çš„äº’è”ç½‘ä¸­ï¼Œæœ‰è¿™æ ·ä¸€ç§"çˆ¬è™«ç”Ÿç‰©"ï¼Œç©¿æ¢­äºä¸‡ç»´ç½‘ä¸­ï¼Œå°†æ‰¿è½½ä¿¡æ¯çš„ç½‘é¡µåé£Ÿï¼Œç„¶åäº¤ç”±æœç´¢å¼•æ“è¿›è¡Œè½¬åŒ–ï¼Œå¸æ”¶ï¼Œå¹¶æœ€ç»ˆ"å­µåŒ–"å‡ºç»“æ„åŒ–çš„æ•°æ®ï¼Œä¾›äººå¿«é€ŸæŸ¥æ‰¾ï¼Œå±•ç¤ºã€‚

è¿™ç§"ç”Ÿç‰©"ï¼Œå…¶åæ›°"ç½‘ç»œèœ˜è››"ï¼ˆåˆè¢«ç§°ä¸ºç½‘é¡µèœ˜è››ï¼Œç½‘ç»œæœºå™¨äººï¼‰ã€‚ç½‘ç»œèœ˜è››è™½ä»¥æ•°æ®ä¸ºé£Ÿï¼Œä½†æ˜¯æ•°æ®çš„ç”Ÿäº§è€…-ç½‘ç«™ï¼Œä¹Ÿéœ€è¦å€ŸåŠ©çˆ¬è™«çš„å¸®åŠ©ï¼Œå°†ç½‘é¡µæäº¤ç»™æœç´¢å¼•æ“ã€‚

```{r out.width = "30%", echo = FALSE}
knitr::include_graphics("http://www.chipscoco.com/zb_users/upload/2021/02/202102051612492579435384.jpg")
```
---

## ä¸ºä»€ä¹ˆè¦çˆ¬è™«

- ç¤¾ä¼šç§‘å­¦ç ”ç©¶éœ€è¦çš„æ•°æ®æ›´åŠ å¤šå…ƒ

- ä½†æ•°æ®æºæ‹’ç»ç»™æˆ‘ä»¬ç»“æ„åŒ–çš„æ•°æ®æŸ¥è¯¢æ–¹å¼æˆ–API

---

## çˆ¬è™«èƒ½å¹²ä»€ä¹ˆï¼Ÿ

## çˆ¬è™«çš„å…¸å‹æ¡ˆä¾‹ï¼šæœç´¢å¼•æ“

æœç´¢å¼•æ“æ˜¯Webæ—¶ä»£ç”¨æˆ·ä½¿ç”¨äº’è”ç½‘çš„å…¥å£å’ŒæŒ‡å—ã€‚

ç½‘ç»œçˆ¬è™«æ˜¯æœç´¢å¼•æ“ç³»ç»Ÿä¸­ååˆ†é‡è¦çš„ç»„æˆéƒ¨åˆ†ï¼Œå®ƒè´Ÿè´£ä»äº’è”ç½‘ä¸­æœé›†ç½‘é¡µï¼Œé‡‡é›†ä¿¡æ¯ï¼Œè¿™äº›ç½‘é¡µä¿¡æ¯ç”¨äºå»ºç«‹ç´¢å¼•ä»è€Œä¸ºæœç´¢å¼•æ“æä¾›æ”¯æŒï¼Œå®ƒå†³å®šç€æ•´ä¸ªå¼•æ“ç³»ç»Ÿçš„å†…å®¹æ˜¯å¦ä¸°å¯Œï¼Œä¿¡æ¯æ˜¯å¦å³æ—¶ï¼Œå› æ­¤å…¶æ€§èƒ½çš„ä¼˜åŠ£ç›´æ¥å½±å“ç€æœç´¢å¼•æ“çš„æ•ˆæœã€‚

```{r out.width = "50%", echo = FALSE}
knitr::include_graphics("https://piaosanlang.gitbooks.io/spiders/content/photos/01-engine.png")
```

---

## ç½‘ç»œåŸºç¡€çŸ¥è¯†

- ç½‘ç»œè®¿é—®æ˜¯ä¸ªä»€ä¹ˆæ ·çš„è¿‡ç¨‹

- URIå’ŒURLï¼šæˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿å­˜åœ¨å“ªé‡Œï¼Ÿ

- Hypertextï¼šæˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿ä»¥ä»€ä¹ˆæ–¹å¼å­˜åœ¨

- HTTPå’ŒHTTPSï¼šæˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿ä»¥ä»€ä¹ˆæ ·çš„æ–¹å¼ä¼ è¾“

- HTTPè¯·æ±‚è¿‡ç¨‹ï¼šæˆ‘ä»¬å¦‚ä½•å‘Šè¯‰åˆ«äººæˆ‘ä»¬æƒ³è¦ä»€ä¹ˆ

---

## ç½‘ç»œè®¿é—®æ˜¯ä¸ªä»€ä¹ˆæ ·çš„è¿‡ç¨‹

> â€œç½‘ç«™æ˜¯æŠŠä¸ªäººè®¡ç®—æœºè¿ä¸Šç½‘ç»œçš„è¿‡ç¨‹ï¼Œçˆ¬è™«å°±æ˜¯é€šè¿‡ç½‘ç»œåˆ°åˆ«äººè®¡ç®—æœºä¸‹è½½æ•°æ®â€

çˆ¬è™«æ˜¯æ¨¡æ‹Ÿç”¨æˆ·åœ¨æµè§ˆå™¨æˆ–è€…æŸä¸ªåº”ç”¨ä¸Šçš„æ“ä½œï¼ŒæŠŠæ“ä½œçš„è¿‡ç¨‹ã€å®ç°è‡ªåŠ¨åŒ–çš„ç¨‹åºã€‚
å½“æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ä¸€ä¸ªurlåå›è½¦ï¼Œåå°ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ

ç®€å•æ¥è¯´è¿™æ®µè¿‡ç¨‹å‘ç”Ÿäº†ä»¥ä¸‹å››ä¸ªæ­¥éª¤ï¼š

- æŸ¥æ‰¾åŸŸåå¯¹åº”çš„IPåœ°å€ã€‚

- å‘IPå¯¹åº”çš„æœåŠ¡å™¨å‘é€è¯·æ±‚ã€‚

- æœåŠ¡å™¨å“åº”è¯·æ±‚ï¼Œå‘å›ç½‘é¡µå†…å®¹ã€‚

- æµè§ˆå™¨è§£æç½‘é¡µå†…å®¹ã€‚

---

## ç½‘ç»œè®¿é—®æ˜¯ä¸ªä»€ä¹ˆæ ·çš„è¿‡ç¨‹

```{r out.width = "90%", echo = FALSE}
knitr::include_graphics("https://piaosanlang.gitbooks.io/spiders/content/photos/01-webdns.jpg")
```

---

## URIå’ŒURLï¼šæˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿å­˜åœ¨å“ªé‡Œï¼Ÿ

Universar Resource Locator(URL)ï¼Œç»Ÿä¸€èµ„æºå®šä½ç¬¦

Uniform Resource Identifier(URI)ï¼Œç»Ÿä¸€èµ„æºæ ‡å¿—ç¬¦

--

URI = URN + URL

--

URN:åªå‘½åèµ„æºè€Œä¸æŒ‡å®šå¦‚ä½•å®šä½èµ„æºï¼Œæ¯”å¦‚:

isbn:1203102348

å®ƒåªæ˜¯æŒ‡å®šäº†ä¸€æœ¬ä¹¦çš„ISBNï¼Œå¯ä»¥å”¯ä¸€æ ‡è¯†è¿™æœ¬ä¹¦ï¼Œä½†æ˜¯æ²¡æœ‰æŒ‡å®šåˆ°å“ªé‡Œå®šä½è¿™æœ¬ä¹¦

---

## URL

> https://www.baidu.com/

> https://github.com/syfyufei/Rworkshop2022/blob/main/WebCrawler/WebCrawler.html

> http://166.111.105.29:8787/


urlçš„åŸºæœ¬æ ¼å¼ï¼š

- schema://host[:port#]/path/â€¦/

- schemaï¼š åè®®ï¼ˆä¾‹å¦‚ï¼šhttpï¼Œhttpsï¼Œftpï¼‰

- hostï¼šæœåŠ¡å™¨çš„IPæˆ–åŸŸå

- portï¼šæœåŠ¡å™¨çš„ç«¯å£

- pathï¼šè®¿é—®èµ„æºçš„è·¯å¾„

---

## Hypertextï¼šæˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿ä»¥ä»€ä¹ˆæ–¹å¼å­˜åœ¨

è¶…æ–‡å­—ï¼ˆHypertextï¼‰ï¼šæµè§ˆå™¨é‡Œçœ‹åˆ°çš„ç½‘é¡µå°±æ˜¯Hypertextè§£æè€Œæˆçš„ï¼Œå…¶ç½‘é¡µæºä»£ç æ˜¯ä¸€ç³»åˆ—çš„HTMLä»£ç ï¼Œé‡Œé¢åŒ…å«äº†ä¸€ç³»åˆ—çš„æ ‡ç­¾ï¼Œæ¯”å¦‚ï¼š

- img æ ‡ç­¾æ˜¾ç¤ºå›¾ç‰‡
- p æ ‡ç­¾æŒ‡å®šæ˜¾ç¤ºæ®µè½
- aæ ‡ç­¾æŒ‡å®šé“¾æ¥

--

.navy[å­¦ä¼šçœ‹æºç å•¦ï¼Œä¸‹æ¬¡é‡åˆ°æŸäº›ç½‘é¡µç¦æ­¢å¤åˆ¶ç½‘é¡µå†…å®¹ï¼Œä½ æƒ³åˆ°äº†è§£å†³åŠæ³•å—ï¼Ÿ]

https://blog.csdn.net/apsw6825/article/details/123993027?spm=1001.2100.3001.7377&utm_medium=distribute.pc_feed_blog_category.none-task-blog-classify_tag-5-123993027-null-null.nonecase&depth_1-utm_source=distribute.pc_feed_blog_category.none-task-blog-classify_tag-5-123993027-null-null.nonecase

---

## HTTPå’ŒHTTPSï¼šæˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿ä»¥ä»€ä¹ˆæ ·çš„æ–¹å¼ä¼ è¾“

æ–‡æœ¬ä¼ è¾“åè®®ï¼š

- http

- https

- ftp

- sftp


HTTPï¼ˆHyper Text Transfer Protocol)è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œç”¨äºä»ç½‘ç»œä¼ è¾“è¶…æ–‡æœ¬æ•°æ®åˆ°æœ¬åœ°æµè§ˆå™¨çš„ä¼ è¾“åè®®ï¼Œèƒ½ä¿è¯é«˜æ•ˆè€Œå‡†ç¡®çš„ä¼ é€è¶…æ–‡æœ¬æ–‡æ¡£ã€‚ç”±ä¸‡ç»´ç½‘åä¼šï¼ˆWorld Wide Web Consortiumï¼‰å’ŒInternetå·¥ä½œå°ç»„IETFï¼ˆInternet Engineering Task Forceï¼‰å…±åŒåˆä½œå’Œåˆ¶å®šçš„è§„èŒƒã€‚

HTTPSï¼ˆHyper Test Transfer protocol over .red[Secure Socket Layer]ï¼‰æ˜¯ä»¥å®‰å…¨ä¸ºç›®æ ‡çš„HTTPé€šé“ï¼Œç®€å•è®²æ˜¯HTTPçš„å®‰å…¨ç‰ˆï¼Œå³HTTPä¸‹åŠ å…¥SSLå±‚ï¼Œç®€ç§°ä¸ºHTTPSï¼Œå®‰å…¨åŸºç¡€æ˜¯SSLï¼Œå› æ­¤é€šè¿‡å®ƒä¼ è¾“çš„å†…å®¹éƒ½æ˜¯ç»è¿‡SSLåŠ å¯†ã€‚

---

## è¯·æ±‚å’Œå“åº”ï¼šæˆ‘ä»¬å¦‚ä½•å‘Šè¯‰åˆ«äººæˆ‘ä»¬æƒ³è¦ä»€ä¹ˆ

åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ä¸€ä¸ªurlï¼Œå›è½¦ä¹‹åä¾¿å¯ä»¥åœ¨æµè§ˆå™¨ä¸­è§‚å¯Ÿåˆ°é¡µé¢å†…å®¹ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯æµè§ˆå™¨å‘ç½‘ç«™æ‰€åœ¨çš„æœåŠ¡å™¨å‘é€äº†ä¸€ä¸ªè¯·æ±‚ï¼Œç½‘ç«™çš„æœåŠ¡å™¨æ¥æ”¶åˆ°è¿™ä¸ªè¯·æ±‚åè¿›è¡Œå¤„ç†å’Œè§£æï¼Œç„¶åå°†å¯¹åº”çš„å“åº”ä¼ å›ç»™æµè§ˆå™¨ã€‚

- General(æ€»è§ˆ)

- Response Headersï¼ˆå“åº”å¤´ï¼‰

- **Request Headersï¼ˆè¯·æ±‚å¤´ï¼‰**

---

## è¯·æ±‚

- è¯·æ±‚æ–¹æ³•ï¼ˆRequest Method)

- è¯·æ±‚çš„ç½‘å€ï¼ˆRequest URLï¼‰

- è¯·æ±‚å¤´ ï¼ˆRequest Headers)

---

## è¯·æ±‚æ–¹æ³•

GET:

åœ¨æµè§ˆå™¨ä¸­ç›´æ¥è¾“å…¥URLå¹¶å›è½¦ï¼Œä¾¿å‘èµ·äº†ä¸€ä¸ªGETè¯·æ±‚ï¼Œè¯·æ±‚çš„å‚æ•°ä¼šåŒ…å«åœ¨URLä¸­


POST:

POSTè¯·æ±‚å¤§å¤šæ•°åœ¨è¡¨å•æäº¤æ—¶å‘èµ·ï¼Œä¾‹å¦‚ï¼šå¯¹äºä¸€ä¸ªç™»å½•è¡¨å•ï¼Œè¾“å…¥ç”¨æˆ·åå’Œå¯†ç åï¼Œç‚¹å‡»â€œç™»å½•â€æŒ‰é’®ï¼Œè¿™é€šå¸¸ä¼šå‘èµ·ä¸€ä¸ªPOSTè¯·æ±‚ï¼Œèµ·æ•°æ®é€šå¸¸ä»¥è¡¨å•çš„å½¢å¼ä¼ è¾“ï¼Œè€Œä¸ä¼šä½“ç°åœ¨URLä¸­ã€‚


GETå’ŒPOSTçš„åŒºåˆ«ï¼š

- GETè¯·æ±‚ä¸­çš„å‚æ•°åŒ…å«åœ¨URLä¸­ï¼Œæ•°æ®å¯ä»¥åœ¨URLä¸­çœ‹åˆ°ï¼Œè€ŒPOSTè¯·æ±‚çš„URLä¸ä¼šåŒ…å«è¿™äº›æ•°æ®ï¼Œæ•°æ®éƒ½æ˜¯é€šè¿‡è¡¨å•çš„å½¢å¼ä¼ è¾“çš„ï¼Œä¼šåŒ…å«åœ¨è¯·æ±‚ä½“ä¸­

- GETè¯·æ±‚æäº¤çš„æ•°æ®æœ€å¤šåªæœ‰1024å­—èŠ‚ï¼Œè€ŒPOSTè¯·æ±‚æ²¡æœ‰é™åˆ¶

---

## è¯·æ±‚çš„ç½‘å€

è¯·æ±‚çš„ç½‘å€ï¼šå³ç»Ÿä¸€èµ„æºå®šä½ç¬¦URLï¼Œå¯ä»¥å”¯ä¸€ç¡®å®šæˆ‘ä»¬æƒ³è¦è¯·æ±‚çš„èµ„æº


## è¯·æ±‚å¤´

ç”¨æ¥è¯´æ˜æœåŠ¡å™¨è¦ä½¿ç”¨çš„é™„åŠ ä¿¡æ¯ï¼Œæ¯”è¾ƒé‡è¦çš„ä¿¡æ¯æœ‰Cookieã€User-Agent

Cookieï¼šä¹Ÿå¸¸ç”¨å¤æ•°å½¢å¼Cookiesï¼Œè¿™æ˜¯ç½‘ç«™ä¸ºäº†è¾¨åˆ«ç”¨æˆ·è¿›è¡Œä¼šè¯è·Ÿè¸ªè€Œå­˜å‚¨åœ¨æœ¬åœ°çš„æ•°æ®ï¼Œå®ƒçš„ä¸»è¦åŠŸèƒ½æ˜¯ç»´æŒå½“å‰è®¿é—®ä¼šè¯ã€‚ä¾‹å¦‚ï¼šæˆ‘ä»¬è¾“å…¥ç”¨æˆ·åå’Œå¯†ç æˆåŠŸç™»é™†åˆ°æŸä¸ªç½‘ç«™åï¼ŒæœåŠ¡å™¨ä¼šç”¨ä¼šè¯ä¿å­˜ç™»é™†çŠ¶æ€ä¿¡æ¯ï¼Œåé¢æˆ‘ä»¬æ¯æ¬¡åˆ·æ–°æˆ–è¯·æ±‚è¯¥ç«™ç‚¹çš„å…¶å®ƒé¡µé¢æ—¶ï¼Œä¼šå‘ç°éƒ½æ˜¯ç™»é™†çŠ¶æ€ï¼Œè¿™å°±æ˜¯Cookieçš„åŠŸåŠ³ã€‚Cookiesé‡Œé¢æœ‰ä¿¡æ¯æ ‡è¯†äº†æˆ‘ä»¬æ‰€å¯¹åº”çš„æœåŠ¡å™¨çš„ä¼šè¯ï¼Œæ¯æ¬¡åœ¨è¯·æ±‚è¯¥ç«™ç‚¹æ—¶ï¼Œéƒ½ä¼šåœ¨è¯·æ±‚å¤´é•¿åŠ ä¸ŠCookieså¹¶å°†å…¶å‘é€ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨é€šè¿‡Cookiesè¯†åˆ«å‡ºæ˜¯æˆ‘ä»¬è‡ªå·±ï¼Œå¹¶ä¸”æŸ¥å‡ºå½“å‰çŠ¶æ€æ˜¯ç™»é™†çŠ¶æ€ï¼Œæ‰€ä»¥è¿”å›ç»“æœå°±æ˜¯ç™»é™†ä¹‹åæ‰èƒ½çœ‹åˆ°çš„ç½‘é¡µå†…å®¹ã€‚

User-Agentï¼šç®€ç§°UAï¼Œå®ƒæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å­—ç¬¦ä¸²å¤´ï¼Œå¯ä»¥ä½¿æœåŠ¡å™¨è¯†åˆ«å®¢æˆ·ä½¿ç”¨çš„æ“ä½œç³»ç»ŸåŠç‰ˆæœ¬ã€æµè§ˆå™¨åŠç‰ˆæœ¬ä¿¡æ¯ç­‰ã€‚åœ¨åšçˆ¬è™«æ˜¯åŠ ä¸Šæ­¤ä¿¡æ¯ï¼Œå¯ä»¥å°†çˆ¬è™«ä¼ªè£…æˆæµè§ˆå™¨ï¼Œå¦‚æœä¸åŠ ï¼Œå°†ä¼šæ˜¯é»˜è®¤çš„çˆ¬è™«çš„UAï¼Œå¾ˆæœ‰å¯èƒ½ä¼šè¢«è¯†åˆ«ä¸ºçˆ¬è™«ã€‚

---

## å“åº”

å“åº”çŠ¶æ€ç è¡¨ç¤ºæœåŠ¡å™¨çš„å“åº”çŠ¶æ€ï¼š

200	æ­£å¸¸

301	æœ¬ç½‘é¡µæ°¸ä¹…æ€§è½¬ç§»è¾¾åˆ°å¦ä¸€ä¸ªåœ°å€

400	è¯·æ±‚å‡ºç°è¯­æ³•é”™è¯¯

403	å®¢æˆ·ç«¯æœªèƒ½è·å¾—æˆæƒ

404	åœ¨æŒ‡å®šä½ç½®ä¸å­˜åœ¨æ‰€ç”³è¯·çš„èµ„æº

500	æœåŠ¡å™¨é‡åˆ°äº†æ„æ–™ä¸åˆ°çš„æƒ…å†µ

503	æœåŠ¡å™¨ç”±äºç»´æŠ¤æˆ–è€…è´Ÿè½½è¿‡é‡æœªèƒ½åº”ç­”

---

class: inverse, center, middle

# åˆ©åˆƒå‡ºé˜ï¼šæˆ‘ä»¬çš„çˆ¬è™«å·¥å…·ç®±

---

## åˆ©åˆƒå‡ºé˜ï¼šæˆ‘ä»¬çš„çˆ¬è™«å·¥å…·ç®±

- é›¶ä»£ç çˆ¬è™«å·¥å…·ï¼šâ€œå…«çˆªé±¼â€

- ç¼–ç¨‹è¯­è¨€ä»¬

- ç½‘ç»œæŠ“åŒ…å·¥å…·

---
class: inverse, center, middle

# å°è¯•ç‰›åˆ€ï¼šå¦‚ä½•ä½¿ç”¨â€œå…«çˆªé±¼â€æŠ“å–æ”¿åºœç½‘é¡µ

---

## å¦‚ä½•è§£æä¸€ä¸ªçˆ¬è™«é¡¹ç›®

- äººæ€ä¹ˆæ“ä½œï¼Ÿ

å¯¹äºç½‘ç»œçˆ¬è™«ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ¨¡ä»¿äººç±»ç”¨æˆ·è®¿é—®ç½‘ç«™çš„è¡Œä¸ºã€‚åœ¨å®é™…æ“ä½œä¸­ï¼Œäººç±»ç”¨æˆ·ä¼šé€šè¿‡æµè§ˆå™¨æµè§ˆç½‘é¡µã€ç‚¹å‡»é“¾æ¥ã€å¡«å†™è¡¨å•ç­‰æ–¹å¼ä¸ç½‘ç«™äº¤äº’ã€‚å› æ­¤ï¼Œåœ¨è®¾è®¡ç½‘ç»œçˆ¬è™«æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ¨¡æ‹Ÿè¿™äº›è¡Œä¸ºï¼Œä½¿æˆ‘ä»¬çš„çˆ¬è™«æ›´åƒä¸€ä¸ªçœŸå®ç”¨æˆ·ã€‚

> â€œæ··åœ¨ç¾¤ä¼—é˜Ÿä¼ä¸­æ‰æ˜¯æœ€å®‰å…¨çš„â€

è¿™å¥è¯æ„å‘³ç€ï¼Œè®©çˆ¬è™«å°½é‡æ¨¡æ‹Ÿæ­£å¸¸ç”¨æˆ·çš„è¡Œä¸ºï¼Œè¿™æ ·å°±ä¸å®¹æ˜“è¢«ç½‘ç«™æ£€æµ‹åˆ°ã€‚

---

- æ¨¡ä»¿äºº

ä¸ºäº†è®©çˆ¬è™«æ›´åƒä¸€ä¸ªçœŸå®ç”¨æˆ·ï¼Œæˆ‘ä»¬éœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š

  - è®¾ç½®User-Agentï¼šUser-Agentæ˜¯HTTPè¯·æ±‚å¤´ä¸­çš„ä¸€ä¸ªå­—æ®µï¼Œå®ƒå‘Šè¯‰æœåŠ¡å™¨å‘èµ·è¯·æ±‚çš„å®¢æˆ·ç«¯ä¿¡æ¯ã€‚è®¾ç½®åˆé€‚çš„User-Agentå¯ä»¥è®©çˆ¬è™«çœ‹èµ·æ¥åƒä¸€ä¸ªæ­£å¸¸æµè§ˆå™¨ã€‚
  
  - å¤„ç†JavaScriptï¼šè®¸å¤šç½‘ç«™ä½¿ç”¨JavaScriptåŠ¨æ€åŠ è½½å†…å®¹ï¼Œå› æ­¤çˆ¬è™«éœ€è¦èƒ½å¤Ÿæ‰§è¡ŒJavaScriptã€‚å¯ä»¥ä½¿ç”¨åƒSeleniumè¿™æ ·çš„å·¥å…·å®ç°ã€‚
  
  - é™åˆ¶çˆ¬å–é€Ÿåº¦ï¼šé¿å…åœ¨çŸ­æ—¶é—´å†…å‘é€å¤§é‡è¯·æ±‚ï¼Œè¿™æ ·å¯ä»¥å‡è½»ç›®æ ‡æœåŠ¡å™¨çš„è´Ÿæ‹…ï¼Œå¹¶é™ä½è¢«æ£€æµ‹åˆ°çš„é£é™©ã€‚å¯ä»¥é€šè¿‡è®¾ç½®å»¶è¿Ÿæˆ–ä½¿ç”¨ä»£ç†IPè½®æ¢å®ç°ã€‚

---

- æœ‰ä»€ä¹ˆåçˆ¬æœºåˆ¶ï¼Ÿ

ç½‘ç«™å¯èƒ½ä¼šé‡‡å–ä»¥ä¸‹ä¸€äº›åçˆ¬æœºåˆ¶ï¼š

  - æ£€æµ‹User-Agentï¼šå¦‚æœUser-Agentçœ‹èµ·æ¥ä¸åƒä¸€ä¸ªæ­£å¸¸æµè§ˆå™¨ï¼ŒæœåŠ¡å™¨å¯èƒ½ä¼šæ‹’ç»è¯·æ±‚ã€‚
  
  - æ£€æµ‹è¯·æ±‚é€Ÿåº¦ï¼šå¦‚æœåœ¨çŸ­æ—¶é—´å†…æ¥æ”¶åˆ°å¤§é‡è¯·æ±‚ï¼ŒæœåŠ¡å™¨å¯èƒ½ä¼šè®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªçˆ¬è™«ã€‚
  
  - éªŒè¯ç ï¼šä¸€äº›ç½‘ç«™å¯èƒ½ä¼šè¦æ±‚ç”¨æˆ·è¾“å…¥éªŒè¯ç ä»¥ç¡®è®¤å…¶èº«ä»½ã€‚
  
  - ä½¿ç”¨Cookieå’ŒSessionï¼šç½‘ç«™å¯èƒ½ä¼šä½¿ç”¨Cookieå’ŒSessionæ¥è·Ÿè¸ªç”¨æˆ·ï¼Œå¹¶é˜»æ­¢æ²¡æœ‰åˆæ³•Cookieæˆ–Sessionçš„è¯·æ±‚ã€‚

---

- æˆ‘ä»¬åº”è¯¥å¦‚ä½•çªç ´è¿™äº›åçˆ¬æœºåˆ¶ï¼Ÿ

ä¸ºäº†çªç ´è¿™äº›åçˆ¬æœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡å–ä»¥ä¸‹æªæ–½ï¼š

  - è®¾ç½®åˆé€‚çš„User-Agentï¼šä½¿ç”¨å¸¸è§æµè§ˆå™¨çš„User-Agentï¼Œæˆ–è€…ä½¿ç”¨åº“ï¼ˆå¦‚fake_useragentï¼‰æ¥ç”ŸæˆéšæœºUser-Agentã€‚
  
  - é™åˆ¶çˆ¬å–é€Ÿåº¦ï¼šè®¾ç½®è¯·æ±‚ä¹‹é—´çš„å»¶è¿Ÿï¼Œæˆ–è€…ä½¿ç”¨ä»£ç†IPè½®æ¢ã€‚
  
  - å¤„ç†éªŒè¯ç ï¼šå¯¹äºç®€å•çš„éªŒè¯ç ï¼Œå¯ä»¥ä½¿ç”¨OCRï¼ˆå…‰å­¦å­—ç¬¦è¯†åˆ«ï¼‰æŠ€æœ¯è¯†åˆ«ã€‚å¯¹äºå¤æ‚çš„éªŒè¯ç ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ç¬¬ä¸‰æ–¹éªŒè¯ç è¯†åˆ«æœåŠ¡ã€‚
  
  - ç®¡ç†Cookieå’ŒSessionï¼šä½¿ç”¨åº“ï¼ˆå¦‚requestsï¼‰æ¥è‡ªåŠ¨å¤„ç†Cookieå’ŒSessionã€‚

---

- æœ‰æ²¡æœ‰å¥½æ–¹æ³•ï¼Ÿ

æœ‰ä¸€äº›æ›´é«˜çº§çš„æ–¹æ³•å¯ä»¥æé«˜çˆ¬è™«çš„æ•ˆæœå’Œæ•ˆç‡ï¼š

  - ä½¿ç”¨åˆ†å¸ƒå¼çˆ¬è™«ï¼šé€šè¿‡å¤šå°è®¡ç®—æœºæˆ–å¤šä¸ªçº¿ç¨‹åŒæ—¶è¿è¡Œçˆ¬è™«ï¼Œå¯ä»¥æé«˜çˆ¬å–é€Ÿåº¦ã€‚ä½†è¦æ³¨æ„éµå®ˆç›®æ ‡ç½‘ç«™çš„çˆ¬è™«æ”¿ç­–ï¼Œé¿å…ç»™æœåŠ¡å™¨å¸¦æ¥è¿‡å¤§è´Ÿæ‹…ã€‚
  
  - ä½¿ç”¨ä»£ç†æ± ï¼šç»´æŠ¤ä¸€ä¸ªä»£ç†IPæ± ï¼Œè½®æ¢ä½¿ç”¨ä»£ç†IPæ¥å‘èµ·è¯·æ±‚ï¼Œå¯ä»¥é™ä½è¢«æ£€æµ‹åˆ°çš„é£é™©ã€‚
  
  - ä½¿ç”¨æœºå™¨å­¦ä¹ æŠ€æœ¯ï¼šå¯¹äºå¤æ‚çš„ç½‘ç«™ç»“æ„ï¼Œå¯ä»¥ä½¿ç”¨æœºå™¨å­¦ä¹ æŠ€æœ¯ï¼ˆå¦‚è‡ªç„¶è¯­è¨€å¤„ç†ã€è®¡ç®—æœºè§†è§‰ç­‰ï¼‰æ¥æå–æ‰€éœ€çš„ä¿¡æ¯ã€‚
  
  - ä½¿ç”¨APIï¼šè®¸å¤šç½‘ç«™æä¾›APIæ¥å£ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡APIè·å–æ•°æ®ã€‚è¿™æ¯”çˆ¬å–ç½‘é¡µæ›´é«˜æ•ˆï¼Œä¹Ÿæ›´å®¹æ˜“ç»´æŠ¤ã€‚ä½†è¦æ³¨æ„éµå®ˆAPIä½¿ç”¨è§„å®šï¼Œé¿å…è§¦å‘APIé™åˆ¶ã€‚

æ€»ä¹‹ï¼Œè¦å»ºç«‹ä¸€ä¸ªé«˜æ•ˆä¸”ç¨³å®šçš„çˆ¬è™«ï¼Œéœ€è¦æ ¹æ®ç›®æ ‡ç½‘ç«™çš„ç‰¹ç‚¹å’Œåçˆ¬ç­–ç•¥é‡‡å–ç›¸åº”çš„æ–¹æ³•ã€‚åŒæ—¶ï¼Œå§‹ç»ˆè¦éµå®ˆç½‘ç«™çš„çˆ¬è™«æ”¿ç­–å’Œæ³•å¾‹æ³•è§„ï¼Œå°Šé‡ç½‘ç«™çš„ç‰ˆæƒå’Œéšç§ã€‚



---

## å°è¯•ç‰›åˆ€ï¼šå¦‚ä½•ä½¿ç”¨â€œå…«çˆªé±¼â€æŠ“å–æ•°æ®

---

## å°è¯•ç‰›åˆ€ï¼šå¦‚ä½•ä½¿ç”¨RæŠ“å–æ”¿åºœç½‘é¡µ

- æ„é€ URLsæ± å­

- å¾ªç¯è¿›è¡Œ

> http://sousuo.gov.cn/column/31421/0.htm?

---

## æ„é€ URLsæ± å­

```{r}

# å®‰è£…å¿…è¦çš„åŒ…
if (!requireNamespace("rvest", quietly = TRUE)) {
  install.packages("rvest")
}
if (!requireNamespace("tidyverse", quietly = TRUE)) {
  install.packages("tidyverse")
}

# åŠ è½½åº“
library(rvest)
library(tidyverse)

# åˆå§‹åŒ–ç©ºçš„æ•°æ®æ¡†
news_data <- tibble(title = character(), content = character())

# å®šä¹‰çˆ¬å–çš„æ€»é¡µæ•°
total_pages <- 1979

# å¾ªç¯çˆ¬å–æ¯ä¸€é¡µçš„æ–°é—»
for (page in 0:total_pages) {
  # æ„å»ºæ¯ä¸€é¡µçš„ç½‘å€
  url <- paste0("http://sousuo.gov.cn/column/31421/", page, ".htm?")

  # è¯»å–é¡µé¢å†…å®¹
  page_content <- read_html(url)

  # æå–æ–°é—»é“¾æ¥
  news_links <- page_content %>% html_nodes(".listTxt a") %>% html_attr("href")

  # å¾ªç¯çˆ¬å–æ¯ä¸€ä¸ªæ–°é—»é“¾æ¥
  for (link in news_links) {
    # è¯»å–æ–°é—»é¡µé¢
    news_page <- read_html(link)

    # æå–æ–°é—»æ ‡é¢˜å’Œå†…å®¹
    title <- news_page %>% html_nodes("h1") %>% html_text(trim = TRUE)
    content <- news_page %>% html_nodes("#UCAP-CONTENT") %>% html_text(trim = TRUE)

    # å°†æ–°é—»æ•°æ®æ·»åŠ åˆ°æ•°æ®æ¡†ä¸­
    news_data <- news_data %>% add_row(title = title, content = content)
  }

  # è¾“å‡ºè¿›åº¦
  cat("å·²å®Œæˆç¬¬", page + 1, "é¡µï¼Œå…±", total_pages + 1, "é¡µ\n")
}

# è¾“å‡ºçˆ¬å–åˆ°çš„æ–°é—»æ•°æ®
print(news_data)

```



```{r, eval = FALSE}

# http://selectorgadget.com/

urls<- data.frame(1:141)
names(urls) <- "url"
for (n in 1:141) {
  urls$url[n] <- paste0("http://www.ngd.org.cn/xwzx/ywdt/index", n, ".htm")
  print(n)
}
dpnews_CPAWDP <- data.frame()

for (n in 1:length(urls$url)) {
  partlink <- read_html(urls$url[n]) %>% 
  html_nodes(".gp-ellipsis a") %>% 
  html_attrs()
  linksP1 <- data.frame(unlist(partlink))
  dpnews_CPAWDP <- rbind(dpnews_CPAWDP, linksP1)
  print(n)
}

dpnews_CPAWDP$url <- paste0("http://www.ngd.org.cn/xwzx/ywdt/", dpnews_CPAWDP$unlist.partlink.)

for (b in 1:length(dpnews_CPAWDP$url)) {
  html <- dpnews_CPAWDP$url[b]
  dpnews_CPAWDP$title[b] <- read_html(html) %>% 
             html_nodes("#shareTitle") %>% 
             html_text()
  dpnews_CPAWDP$author[b] <- read_html(html) %>% 
             html_nodes(".articleAuthor span:nth-child(1)") %>% 
             html_text()
  dpnews_CPAWDP$author[b] <- read_html(html) %>% 
             html_nodes(".articleAuthor span:nth-child(5)") %>% 
             html_text()
  dpnews_CPAWDP$content[b] <- read_html(html) %>% 
             html_nodes("span") %>% 
             html_text()
  print(b)
}

https://www.gov.mo/zh-hant/news-search/page/100/?category_id&entity_id&start_date&end_date

read_html("https://www.gov.mo/zh-hant/news-search/page/100/?category_id&entity_id&start_date&end_date") %>% 
  html_nodes(".links a") %>% 
  html_attrs()

```

```{r}
temp <- read_html(paste0("https://api.isuresults.eu/events/?page=", 1)) %>% 
  html_nodes("p") %>% 
  html_text()
url1 <- jsonlite::fromJSON(temp, simplifyVector = TRUE)[[4]]

for(a in 2:5){
  temp <- read_html(paste0("https://api.isuresults.eu/events/?page=", a)) %>% 
  html_nodes("p") %>% 
  html_text()
  url <- jsonlite::fromJSON(temp, simplifyVector = TRUE)[[4]]
  url1 <- bind_rows(url1, url)
  print(a)
}

data <- as.data.frame(url1$scheduleUrl)

write_csv2(data, "/Users/sunyufei/Desktop/temp.csv")

data <- read_csv("/Users/sunyufei/Desktop/temp.csv")

names(data) <- "scheduleUrl"

urls <- read_csv("/Users/sunyufei/Desktop/ISU Speed Skating Results - Live.csv")



for (b in 1:urls$colxs2_é“¾æ¥1) {
  url <- read_html(urls$colxs2_é“¾æ¥1[b]) %>% 
    html_nodes(".row-button:nth-child(2) .btn-skating") %>% 
    html_attr()
}

url1$scheduleUrl[1]

names(jsonlite::fromJSON(temp, simplifyVector = TRUE))
url2 <- jsonlite::fromJSON(temp, simplifyVector = TRUE)[[5]][[2]]

url <- paste0(url2$url[1], "results")

data <- data_frame(data$links)

data$`data$links`

data1 <- read.csv("/Users/sunyufei/Desktop/ISUSpeedSkatingResultsData1.csv")
data2 <- read.csv("/Users/sunyufei/Desktop/ISUSpeedSkatingResultsData2.csv")
data3 <- read.csv("/Users/sunyufei/Desktop/ISUSpeedSkatingResultsData3.csv")
data4 <- read.csv("/Users/sunyufei/Desktop/ISUSpeedSkatingResultsData4.csv")
data5 <- read.csv("/Users/sunyufei/Desktop/ISUSpeedSkatingResultsData5.csv")

data <- rbind(data1, data2, data3, data4, data5)

write.csv(data, "/Users/sunyufei/Desktop/ISUSpeedSkatingResultsData.csv")




```


```{r}

data <- readxl::read_excel("/Users/sunyufei/Desktop/ISUSpeedSkatingResultsData.xlsx") %>% 
  dplyr::filter(nchar(nationality) > 1)

for (a in 1:length(data$æ–‡æœ¬)) {
  data$event[a] <- unlist(strsplit(data$æ–‡æœ¬[a], "Referee", fixed= T))[1]
  print(a)
}

for (b in 1:length(data$æ–‡æœ¬)) {
  data$name[b] <- unlist(strsplit(data$å­—æ®µ[b], "\r"))[1]
  print(b)
}

for (c in 1:length(data$æ–‡æœ¬)) {
  data$age[c] <- unlist(strsplit(data$å­—æ®µ4[c], " | "))[2]
  print(c)
}

for (d in 1:length(data$æ–‡æœ¬)) {
  data$gender[d] <- unlist(strsplit(data$å­—æ®µ4[d], " | "))[4]
  print(d)
}

```


```{r}

library(rvest)

read_html("https://www2.ed.gov/policy/landing.jhtml?src=pn") %>% 
  html_nodes("#featuretable a") %>% 
  html_attrs()


```
---

## å¤§è¯•ç‰›åˆ€ï¼šå¦‚ä½•çˆ¬å–å¾®ä¿¡å…¬ä¼—å·

## é¡¹ç›®è§£æï¼šå›°éš¾åœ¨å“ªï¼Ÿ

- å¾®ä¿¡å…¬ä¼—å·å†å²çš„æ‰€æœ‰æ–‡ç« ï¼ˆåœ¨å°é—­çš„ç³»ç»Ÿå†…å¦‚ä½•æ„é€ IPæ± å­ï¼‰

--

-å¦‚ä½•è·å¾—æ°¸ä¹…é“¾æ¥

--

- åœ¨ç½‘é¡µæ‰“å¼€æ˜¯çœ‹ä¸åˆ°è¯„è®ºçš„å•Šå–‚


---

## ç½‘ç»œæŠ“åŒ…

äº’åŠ¨ç¯èŠ‚ï¼šä»€ä¹ˆæ˜¯æŠ“åŒ…ï¼Ÿ

--

æŠ“åŒ…å°±æ˜¯å°†ç½‘ç»œä¼ è¾“å‘é€ä¸æ¥æ”¶çš„æ•°æ®åŒ…è¿›è¡Œæˆªè·ã€é‡å‘ã€ç¼–è¾‘ã€è½¬å­˜ç­‰æ“ä½œ

```{r out.width = "60%", echo = FALSE}
knitr::include_graphics("https://pic1.zhimg.com/80/v2-dbea07ea287aee9383bf51fb65f82524_720w.jpg")
```

---

class: inverse, center, middle

# ğŸ¦€ï¸èŸ¹èŸ¹ğŸ¦€ï¸

ğŸ“§[sunyf20@mails.tsinghua.edu.cn](mailto:sunyf20@mails.tsinghua.edu.cn) 

ğŸ§‘â€ğŸ’»[Github: syfyufei](https://syfyufei.github.io/)

ğŸ’»[Yufei Sun: github.com/syfyufei](https://github.com/syfyufei)



## ä¸ºä»€ä¹ˆè¦çˆ¬è™«

- ç¤¾ä¼šç§‘å­¦ç ”ç©¶éœ€è¦çš„æ•°æ®æ›´åŠ å¤šå…ƒ

::: {.callout-note}

# é—®é¢˜æ—¶é—´åˆ°ğŸ™‹

ä½ èƒ½æƒ³åˆ°ä½ çš„ç ”ç©¶é¢†åŸŸèƒ½å¤Ÿç”¨åˆ°å“ªäº›éœ€è¦çˆ¬å–çš„æ•°æ®ï¼Ÿ

:::

- ä½†æ•°æ®æºæ‹’ç»ç»™æˆ‘ä»¬ç»“æ„åŒ–çš„æ•°æ®æŸ¥è¯¢æ–¹å¼æˆ–API

::: {.callout-note}

## API

ä½ èƒ½æƒ³åˆ°å›å½’åˆ†æçš„å‡ ä¸ªåŸºæœ¬å‡è®¾ï¼Ÿ

:::

---

## çˆ¬è™«èƒ½å¹²ä»€ä¹ˆï¼Ÿ

## çˆ¬è™«çš„å…¸å‹æ¡ˆä¾‹ï¼šæœç´¢å¼•æ“

æœç´¢å¼•æ“æ˜¯Webæ—¶ä»£ç”¨æˆ·ä½¿ç”¨äº’è”ç½‘çš„å…¥å£å’ŒæŒ‡å—ã€‚

ç½‘ç»œçˆ¬è™«æ˜¯æœç´¢å¼•æ“ç³»ç»Ÿä¸­ååˆ†é‡è¦çš„ç»„æˆéƒ¨åˆ†ï¼Œå®ƒè´Ÿè´£ä»äº’è”ç½‘ä¸­æœé›†ç½‘é¡µï¼Œé‡‡é›†ä¿¡æ¯ï¼Œè¿™äº›ç½‘é¡µä¿¡æ¯ç”¨äºå»ºç«‹ç´¢å¼•ä»è€Œä¸ºæœç´¢å¼•æ“æä¾›æ”¯æŒï¼Œå®ƒå†³å®šç€æ•´ä¸ªå¼•æ“ç³»ç»Ÿçš„å†…å®¹æ˜¯å¦ä¸°å¯Œï¼Œä¿¡æ¯æ˜¯å¦å³æ—¶ï¼Œå› æ­¤å…¶æ€§èƒ½çš„ä¼˜åŠ£ç›´æ¥å½±å“ç€æœç´¢å¼•æ“çš„æ•ˆæœã€‚

```{r out.width = "50%", echo = FALSE}
knitr::include_graphics("https://piaosanlang.gitbooks.io/spiders/content/photos/01-engine.png")
```

---

## ç½‘ç»œåŸºç¡€çŸ¥è¯†

- ç½‘ç»œè®¿é—®æ˜¯ä¸ªä»€ä¹ˆæ ·çš„è¿‡ç¨‹

- URIå’ŒURLï¼šæˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿å­˜åœ¨å“ªé‡Œï¼Ÿ

- Hypertextï¼šæˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿ä»¥ä»€ä¹ˆæ–¹å¼å­˜åœ¨

- HTTPå’ŒHTTPSï¼šæˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿ä»¥ä»€ä¹ˆæ ·çš„æ–¹å¼ä¼ è¾“

- HTTPè¯·æ±‚è¿‡ç¨‹ï¼šæˆ‘ä»¬å¦‚ä½•å‘Šè¯‰åˆ«äººæˆ‘ä»¬æƒ³è¦ä»€ä¹ˆ

---

## ç½‘ç»œè®¿é—®æ˜¯ä¸ªä»€ä¹ˆæ ·çš„è¿‡ç¨‹

> â€œç½‘ç«™æ˜¯æŠŠä¸ªäººè®¡ç®—æœºè¿ä¸Šç½‘ç»œçš„è¿‡ç¨‹ï¼Œçˆ¬è™«å°±æ˜¯é€šè¿‡ç½‘ç»œåˆ°åˆ«äººè®¡ç®—æœºä¸‹è½½æ•°æ®â€

çˆ¬è™«æ˜¯æ¨¡æ‹Ÿç”¨æˆ·åœ¨æµè§ˆå™¨æˆ–è€…æŸä¸ªåº”ç”¨ä¸Šçš„æ“ä½œï¼ŒæŠŠæ“ä½œçš„è¿‡ç¨‹ã€å®ç°è‡ªåŠ¨åŒ–çš„ç¨‹åºã€‚
å½“æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ä¸€ä¸ªurlåå›è½¦ï¼Œåå°ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ

ç®€å•æ¥è¯´è¿™æ®µè¿‡ç¨‹å‘ç”Ÿäº†ä»¥ä¸‹å››ä¸ªæ­¥éª¤ï¼š

- æŸ¥æ‰¾åŸŸåå¯¹åº”çš„IPåœ°å€ã€‚

- å‘IPå¯¹åº”çš„æœåŠ¡å™¨å‘é€è¯·æ±‚ã€‚

- æœåŠ¡å™¨å“åº”è¯·æ±‚ï¼Œå‘å›ç½‘é¡µå†…å®¹ã€‚

- æµè§ˆå™¨è§£æç½‘é¡µå†…å®¹ã€‚

---

## ç½‘ç»œè®¿é—®æ˜¯ä¸ªä»€ä¹ˆæ ·çš„è¿‡ç¨‹

```{r out.width = "90%", echo = FALSE}
knitr::include_graphics("https://piaosanlang.gitbooks.io/spiders/content/photos/01-webdns.jpg")
```

---

## URIå’ŒURLï¼šæˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿å­˜åœ¨å“ªé‡Œï¼Ÿ

Universar Resource Locator(URL)ï¼Œç»Ÿä¸€èµ„æºå®šä½ç¬¦

Uniform Resource Identifier(URI)ï¼Œç»Ÿä¸€èµ„æºæ ‡å¿—ç¬¦

--

URI = URN + URL

--

URN:åªå‘½åèµ„æºè€Œä¸æŒ‡å®šå¦‚ä½•å®šä½èµ„æºï¼Œæ¯”å¦‚:

isbn:1203102348

å®ƒåªæ˜¯æŒ‡å®šäº†ä¸€æœ¬ä¹¦çš„ISBNï¼Œå¯ä»¥å”¯ä¸€æ ‡è¯†è¿™æœ¬ä¹¦ï¼Œä½†æ˜¯æ²¡æœ‰æŒ‡å®šåˆ°å“ªé‡Œå®šä½è¿™æœ¬ä¹¦

---

## URL

> https://www.baidu.com/

> https://github.com/syfyufei/Rworkshop2022/blob/main/WebCrawler/WebCrawler.html

> http://166.111.105.29:8787/


urlçš„åŸºæœ¬æ ¼å¼ï¼š

- schema://host[:port#]/path/â€¦/

- schemaï¼š åè®®ï¼ˆä¾‹å¦‚ï¼šhttpï¼Œhttpsï¼Œftpï¼‰

- hostï¼šæœåŠ¡å™¨çš„IPæˆ–åŸŸå

- portï¼šæœåŠ¡å™¨çš„ç«¯å£

- pathï¼šè®¿é—®èµ„æºçš„è·¯å¾„

---

## Hypertextï¼šæˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿ä»¥ä»€ä¹ˆæ–¹å¼å­˜åœ¨

è¶…æ–‡å­—ï¼ˆHypertextï¼‰ï¼šæµè§ˆå™¨é‡Œçœ‹åˆ°çš„ç½‘é¡µå°±æ˜¯Hypertextè§£æè€Œæˆçš„ï¼Œå…¶ç½‘é¡µæºä»£ç æ˜¯ä¸€ç³»åˆ—çš„HTMLä»£ç ï¼Œé‡Œé¢åŒ…å«äº†ä¸€ç³»åˆ—çš„æ ‡ç­¾ï¼Œæ¯”å¦‚ï¼š

- img æ ‡ç­¾æ˜¾ç¤ºå›¾ç‰‡
- p æ ‡ç­¾æŒ‡å®šæ˜¾ç¤ºæ®µè½
- aæ ‡ç­¾æŒ‡å®šé“¾æ¥

--

.navy[å­¦ä¼šçœ‹æºç å•¦ï¼Œä¸‹æ¬¡é‡åˆ°æŸäº›ç½‘é¡µç¦æ­¢å¤åˆ¶ç½‘é¡µå†…å®¹ï¼Œä½ æƒ³åˆ°äº†è§£å†³åŠæ³•å—ï¼Ÿ]

https://blog.csdn.net/apsw6825/article/details/123993027?spm=1001.2100.3001.7377&utm_medium=distribute.pc_feed_blog_category.none-task-blog-classify_tag-5-123993027-null-null.nonecase&depth_1-utm_source=distribute.pc_feed_blog_category.none-task-blog-classify_tag-5-123993027-null-null.nonecase

---

## HTTPå’ŒHTTPSï¼šæˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿ä»¥ä»€ä¹ˆæ ·çš„æ–¹å¼ä¼ è¾“

æ–‡æœ¬ä¼ è¾“åè®®ï¼š

- http

- https

- ftp

- sftp


HTTPï¼ˆHyper Text Transfer Protocol)è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œç”¨äºä»ç½‘ç»œä¼ è¾“è¶…æ–‡æœ¬æ•°æ®åˆ°æœ¬åœ°æµè§ˆå™¨çš„ä¼ è¾“åè®®ï¼Œèƒ½ä¿è¯é«˜æ•ˆè€Œå‡†ç¡®çš„ä¼ é€è¶…æ–‡æœ¬æ–‡æ¡£ã€‚ç”±ä¸‡ç»´ç½‘åä¼šï¼ˆWorld Wide Web Consortiumï¼‰å’ŒInternetå·¥ä½œå°ç»„IETFï¼ˆInternet Engineering Task Forceï¼‰å…±åŒåˆä½œå’Œåˆ¶å®šçš„è§„èŒƒã€‚

HTTPSï¼ˆHyper Test Transfer protocol over .red[Secure Socket Layer]ï¼‰æ˜¯ä»¥å®‰å…¨ä¸ºç›®æ ‡çš„HTTPé€šé“ï¼Œç®€å•è®²æ˜¯HTTPçš„å®‰å…¨ç‰ˆï¼Œå³HTTPä¸‹åŠ å…¥SSLå±‚ï¼Œç®€ç§°ä¸ºHTTPSï¼Œå®‰å…¨åŸºç¡€æ˜¯SSLï¼Œå› æ­¤é€šè¿‡å®ƒä¼ è¾“çš„å†…å®¹éƒ½æ˜¯ç»è¿‡SSLåŠ å¯†ã€‚

---

## è¯·æ±‚å’Œå“åº”ï¼šæˆ‘ä»¬å¦‚ä½•å‘Šè¯‰åˆ«äººæˆ‘ä»¬æƒ³è¦ä»€ä¹ˆ

åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ä¸€ä¸ªurlï¼Œå›è½¦ä¹‹åä¾¿å¯ä»¥åœ¨æµè§ˆå™¨ä¸­è§‚å¯Ÿåˆ°é¡µé¢å†…å®¹ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯æµè§ˆå™¨å‘ç½‘ç«™æ‰€åœ¨çš„æœåŠ¡å™¨å‘é€äº†ä¸€ä¸ªè¯·æ±‚ï¼Œç½‘ç«™çš„æœåŠ¡å™¨æ¥æ”¶åˆ°è¿™ä¸ªè¯·æ±‚åè¿›è¡Œå¤„ç†å’Œè§£æï¼Œç„¶åå°†å¯¹åº”çš„å“åº”ä¼ å›ç»™æµè§ˆå™¨ã€‚

- General(æ€»è§ˆ)

- Response Headersï¼ˆå“åº”å¤´ï¼‰

- **Request Headersï¼ˆè¯·æ±‚å¤´ï¼‰**

---

## è¯·æ±‚

- è¯·æ±‚æ–¹æ³•ï¼ˆRequest Method)

- è¯·æ±‚çš„ç½‘å€ï¼ˆRequest URLï¼‰

- è¯·æ±‚å¤´ ï¼ˆRequest Headers)

---

## è¯·æ±‚æ–¹æ³•

GET:

åœ¨æµè§ˆå™¨ä¸­ç›´æ¥è¾“å…¥URLå¹¶å›è½¦ï¼Œä¾¿å‘èµ·äº†ä¸€ä¸ªGETè¯·æ±‚ï¼Œè¯·æ±‚çš„å‚æ•°ä¼šåŒ…å«åœ¨URLä¸­


POST:

POSTè¯·æ±‚å¤§å¤šæ•°åœ¨è¡¨å•æäº¤æ—¶å‘èµ·ï¼Œä¾‹å¦‚ï¼šå¯¹äºä¸€ä¸ªç™»å½•è¡¨å•ï¼Œè¾“å…¥ç”¨æˆ·åå’Œå¯†ç åï¼Œç‚¹å‡»â€œç™»å½•â€æŒ‰é’®ï¼Œè¿™é€šå¸¸ä¼šå‘èµ·ä¸€ä¸ªPOSTè¯·æ±‚ï¼Œèµ·æ•°æ®é€šå¸¸ä»¥è¡¨å•çš„å½¢å¼ä¼ è¾“ï¼Œè€Œä¸ä¼šä½“ç°åœ¨URLä¸­ã€‚


GETå’ŒPOSTçš„åŒºåˆ«ï¼š

- GETè¯·æ±‚ä¸­çš„å‚æ•°åŒ…å«åœ¨URLä¸­ï¼Œæ•°æ®å¯ä»¥åœ¨URLä¸­çœ‹åˆ°ï¼Œè€ŒPOSTè¯·æ±‚çš„URLä¸ä¼šåŒ…å«è¿™äº›æ•°æ®ï¼Œæ•°æ®éƒ½æ˜¯é€šè¿‡è¡¨å•çš„å½¢å¼ä¼ è¾“çš„ï¼Œä¼šåŒ…å«åœ¨è¯·æ±‚ä½“ä¸­

- GETè¯·æ±‚æäº¤çš„æ•°æ®æœ€å¤šåªæœ‰1024å­—èŠ‚ï¼Œè€ŒPOSTè¯·æ±‚æ²¡æœ‰é™åˆ¶

---

## è¯·æ±‚çš„ç½‘å€

è¯·æ±‚çš„ç½‘å€ï¼šå³ç»Ÿä¸€èµ„æºå®šä½ç¬¦URLï¼Œå¯ä»¥å”¯ä¸€ç¡®å®šæˆ‘ä»¬æƒ³è¦è¯·æ±‚çš„èµ„æº


## è¯·æ±‚å¤´

ç”¨æ¥è¯´æ˜æœåŠ¡å™¨è¦ä½¿ç”¨çš„é™„åŠ ä¿¡æ¯ï¼Œæ¯”è¾ƒé‡è¦çš„ä¿¡æ¯æœ‰Cookieã€User-Agent

Cookieï¼šä¹Ÿå¸¸ç”¨å¤æ•°å½¢å¼Cookiesï¼Œè¿™æ˜¯ç½‘ç«™ä¸ºäº†è¾¨åˆ«ç”¨æˆ·è¿›è¡Œä¼šè¯è·Ÿè¸ªè€Œå­˜å‚¨åœ¨æœ¬åœ°çš„æ•°æ®ï¼Œå®ƒçš„ä¸»è¦åŠŸèƒ½æ˜¯ç»´æŒå½“å‰è®¿é—®ä¼šè¯ã€‚ä¾‹å¦‚ï¼šæˆ‘ä»¬è¾“å…¥ç”¨æˆ·åå’Œå¯†ç æˆåŠŸç™»é™†åˆ°æŸä¸ªç½‘ç«™åï¼ŒæœåŠ¡å™¨ä¼šç”¨ä¼šè¯ä¿å­˜ç™»é™†çŠ¶æ€ä¿¡æ¯ï¼Œåé¢æˆ‘ä»¬æ¯æ¬¡åˆ·æ–°æˆ–è¯·æ±‚è¯¥ç«™ç‚¹çš„å…¶å®ƒé¡µé¢æ—¶ï¼Œä¼šå‘ç°éƒ½æ˜¯ç™»é™†çŠ¶æ€ï¼Œè¿™å°±æ˜¯Cookieçš„åŠŸåŠ³ã€‚Cookiesé‡Œé¢æœ‰ä¿¡æ¯æ ‡è¯†äº†æˆ‘ä»¬æ‰€å¯¹åº”çš„æœåŠ¡å™¨çš„ä¼šè¯ï¼Œæ¯æ¬¡åœ¨è¯·æ±‚è¯¥ç«™ç‚¹æ—¶ï¼Œéƒ½ä¼šåœ¨è¯·æ±‚å¤´é•¿åŠ ä¸ŠCookieså¹¶å°†å…¶å‘é€ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨é€šè¿‡Cookiesè¯†åˆ«å‡ºæ˜¯æˆ‘ä»¬è‡ªå·±ï¼Œå¹¶ä¸”æŸ¥å‡ºå½“å‰çŠ¶æ€æ˜¯ç™»é™†çŠ¶æ€ï¼Œæ‰€ä»¥è¿”å›ç»“æœå°±æ˜¯ç™»é™†ä¹‹åæ‰èƒ½çœ‹åˆ°çš„ç½‘é¡µå†…å®¹ã€‚

User-Agentï¼šç®€ç§°UAï¼Œå®ƒæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å­—ç¬¦ä¸²å¤´ï¼Œå¯ä»¥ä½¿æœåŠ¡å™¨è¯†åˆ«å®¢æˆ·ä½¿ç”¨çš„æ“ä½œç³»ç»ŸåŠç‰ˆæœ¬ã€æµè§ˆå™¨åŠç‰ˆæœ¬ä¿¡æ¯ç­‰ã€‚åœ¨åšçˆ¬è™«æ˜¯åŠ ä¸Šæ­¤ä¿¡æ¯ï¼Œå¯ä»¥å°†çˆ¬è™«ä¼ªè£…æˆæµè§ˆå™¨ï¼Œå¦‚æœä¸åŠ ï¼Œå°†ä¼šæ˜¯é»˜è®¤çš„çˆ¬è™«çš„UAï¼Œå¾ˆæœ‰å¯èƒ½ä¼šè¢«è¯†åˆ«ä¸ºçˆ¬è™«ã€‚

---

## å“åº”

å“åº”çŠ¶æ€ç è¡¨ç¤ºæœåŠ¡å™¨çš„å“åº”çŠ¶æ€ï¼š

200	æ­£å¸¸

301	æœ¬ç½‘é¡µæ°¸ä¹…æ€§è½¬ç§»è¾¾åˆ°å¦ä¸€ä¸ªåœ°å€

400	è¯·æ±‚å‡ºç°è¯­æ³•é”™è¯¯

403	å®¢æˆ·ç«¯æœªèƒ½è·å¾—æˆæƒ

404	åœ¨æŒ‡å®šä½ç½®ä¸å­˜åœ¨æ‰€ç”³è¯·çš„èµ„æº

500	æœåŠ¡å™¨é‡åˆ°äº†æ„æ–™ä¸åˆ°çš„æƒ…å†µ

503	æœåŠ¡å™¨ç”±äºç»´æŠ¤æˆ–è€…è´Ÿè½½è¿‡é‡æœªèƒ½åº”ç­”

è¦åšæ–‡æœ¬åˆ†æï¼Œé¦–å…ˆå¾—æœ‰æ–‡æœ¬ï¼Œæ‰èƒ½è¿›è¡Œåˆ†æã€‚
æˆ‘ä»¬åœ¨ä¸Šä¸€ç« è¯´åˆ°ï¼Œç›®å‰å¯¹äºç¤¾ä¼šç§‘å­¦ä¸­çš„è®¡ç®—æ–‡æœ¬åˆ†ææ¥è¯´ï¼Œå¤§å¤šæ•°ä¸€æ‰‹æ•°æ®éƒ½æ˜¯æ¥è‡ªäºäº’è”ç½‘äº§ç”Ÿçš„æ•°æ®ï¼Œæ‰€ä»¥åœ¨å¼€å§‹å…·ä½“çš„æŠ€æœ¯éƒ¨åˆ†ä¹‹å‰ï¼Œæœ¬ä¹¦é¦–å…ˆè®²è§£å¦‚ä½•ä»ç½‘é¡µè·å–ç”¨äºæ•°æ®ã€‚

## ä»€ä¹ˆæ˜¯ç½‘é¡µæŠ“å–

ç½‘é¡µæŠ“å–ï¼ˆWeb Scrapingï¼‰æ˜¯æŒ‡ä»äº’è”ç½‘ä¸Šè·å–ä¿¡æ¯çš„è¿‡ç¨‹ï¼Œé€šå¸¸é€šè¿‡è‡ªåŠ¨ç¨‹åºï¼ˆç§°ä¸ºçˆ¬è™«æˆ–èœ˜è››ï¼‰è®¿é—®ç½‘ç«™å¹¶æå–æ‰€éœ€çš„æ•°æ®ã€‚
è¿™äº›æ•°æ®å¯ä»¥æ˜¯æ–‡æœ¬ã€å›¾åƒã€é“¾æ¥ç­‰ï¼Œç”¨äºå„ç§ç›®çš„ï¼Œå¦‚åˆ†æã€ç ”ç©¶ã€å±•ç¤ºæˆ–å…¶ä»–åº”ç”¨ã€‚

ç½‘é¡µæŠ“å–çš„åŸºæœ¬æ­¥éª¤åŒ…æ‹¬ï¼š

1. å‘ç°ç½‘é¡µï¼š çˆ¬è™«é¦–å…ˆéœ€è¦çŸ¥é“è¦æŠ“å–çš„ç½‘é¡µçš„åœ°å€ã€‚è¿™å¯ä»¥æ˜¯ä¸€ä¸ªå•ä¸€çš„é¡µé¢æˆ–æ•´ä¸ªç½‘ç«™ã€‚
1. å‘é€**è¯·æ±‚**ï¼š çˆ¬è™«é€šè¿‡HTTPæˆ–HTTPSåè®®å‘ç›®æ ‡æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œè¯·æ±‚é¡µé¢çš„å†…å®¹ã€‚
1. **ä¸‹è½½**ç½‘é¡µçš„HTMLï¼š æœåŠ¡å™¨æ¥æ”¶åˆ°è¯·æ±‚åï¼Œä¼šè¿”å›ç›¸åº”çš„HTMLé¡µé¢ã€‚çˆ¬è™«è·å–è¿™ä¸ªHTMLé¡µé¢çš„å†…å®¹ã€‚
1. **è§£æ**è¯¥HTMLï¼š çˆ¬è™«ä½¿ç”¨è§£æå™¨ï¼ˆå¦‚Beautiful Soupã€Scrapyç­‰ï¼‰æ¥è§£æHTMLï¼Œæå–æ‰€éœ€çš„æ•°æ®ã€‚è¿™å¯èƒ½æ¶‰åŠåˆ°è¯†åˆ«æ ‡ç­¾ã€ç±»ã€IDç­‰HTMLå…ƒç´ ã€‚
1. **æå–**æ•°æ®ï¼š æå–çš„æ•°æ®é€šå¸¸è¢«å­˜å‚¨åœ¨æ•°æ®ç»“æ„ä¸­ï¼Œå¦‚æ•°æ®åº“ã€CSVæ–‡ä»¶æˆ–å…¶ä»–æ ¼å¼ï¼Œä»¥å¤‡åç»­åˆ†ææˆ–ä½¿ç”¨ã€‚

ç½‘é¡µæŠ“å–çš„åº”ç”¨éå¸¸å¹¿æ³›ï¼Œå¯ä»¥ç”¨äºæœç´¢å¼•æ“ç´¢å¼•ã€æ•°æ®æŒ–æ˜ã€èˆ†æƒ…åˆ†æã€ä»·æ ¼æ¯”è¾ƒã€è‡ªåŠ¨åŒ–æµ‹è¯•ç­‰é¢†åŸŸã€‚


## ä½¿ç”¨Rè¿›è¡Œç½‘é¡µæŠ“å–çš„å·¥å…·

åœ¨Rä¸­è¿›è¡Œç½‘é¡µæŠ“å–å¸¸ç”¨çš„æœ‰ä¸‰ä¸ªå·¥å…·ï¼š `rvest`ï¼Œ`RSelenium` å’Œ `Rcrawler`ï¼Œ
å®ƒä»¬è¢«è®¾è®¡ç”¨äºä¸åŒç±»å‹çš„ä»»åŠ¡ã€‚

:::{.callout-tip}
**ä½†æ˜¯**ï¼Œå¦‚æœä½ å‘ç°ä½ åœ¨çˆ¬å–æ•°æ®æ—¶è¾ƒå¤šåœ°ç”¨åˆ°äº†`RSelenium` å’Œ `Rcrawler`ï¼Œè¯´æ˜ä½ ç°åœ¨è¿›è¡Œçš„å·¥ä½œæ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œæœ€å¥½ç›´æ¥æ‰¾ç¬¬ä¸‰æ–¹å¦‚å…«çˆªé±¼ç­‰å¸®å¿™ï¼Œæˆ–è€…ç›´æ¥é€šè¿‡APIè·å–ã€‚
å› ä¸ºåœ¨ç ”ç©¶å·¥ä½œä¸­ï¼Œè·å–æ•°æ®å…¶å®æ˜¯ä¸€ä¸ªæ¯”è¾ƒè´¹åŠ›ä½†æ˜¯åˆæ²¡æœ‰ä»»ä½•å®é™…èƒ½å¤Ÿå†™åˆ°çº¸é¢ä¸Šçš„äº§å‡ºçš„äº‹æƒ…ï¼Œå»ºè®®å¤§å®¶æœ€å¥½å°†æ—¶é—´ç•™ç»™åé¢çš„åˆ†æå’Œå»ºæ¨¡è¿‡ç¨‹ã€‚

å½“ç„¶ï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦å¯¹çˆ¬å–æ•°æ®çš„åŸºæœ¬æŠ€æœ¯æœ‰ä¸€ä¸ªäº†è§£å’ŒæŒæ¡ã€‚
:::

### [`rvest`](https://rvest.tidyverse.org/)

é¦–å…ˆæ˜¯`rvest`åŒ…ï¼Œå®ƒæ˜¯æœ¬ç« ä¸»è¦è®²è§£çš„ä¸€ä¸ªæŠ“å–æ•°æ®çš„åŒ…ï¼Œä¸»è¦åŠŸèƒ½å°±æ˜¯ä½¿æˆ‘ä»¬èƒ½å¤Ÿè½»æ¾æ”¶å‰²ç½‘é¡µã€‚
`rvest`ç»“åˆäº†Pythonçš„ `BeautifulSoup` å’Œ `RoboBrowser`åŠŸèƒ½ï¼Œä½¿ç”¨CSSé€‰æ‹©å™¨ï¼ˆç¨åè¯¦ç»†è¯´æ˜ï¼‰ï¼Œä¹Ÿå¯ä»¥ä¸[`polite`](https://dmi3kno.github.io/polite/)å…¼å®¹ï¼Œâ€œç¤¼è²Œâ€åœ°æŠ“å–å¤šä¸ªé¡µé¢ã€‚ 


### [`RSelenium`](https://docs.ropensci.org/RSelenium/index.html)

`RSelenium`æ˜¯Rç‰ˆæœ¬çš„ `Selenium` (Python)ï¼Œå®ƒæ˜¯ä¸€å¥—ä¸“é—¨ç”¨äºSelenium 2.0çš„Selenium Remote WebDriverçš„Rç»‘å®šï¼Œä½¿ç”¨è‡ªåŠ¨åŒ–æµè§ˆå™¨ã€æœ¬åœ°æˆ–è¿œç¨‹è¿›è¡Œæ“ä½œï¼Œå°±åƒçœŸå®ç”¨æˆ·æ‰‹åŠ¨å¯¼èˆªå®ƒä»¬ä¸€æ ·ã€‚

### [`Rcrawler`](https://github.com/salimk/Rcrawler)

`Rcrawler`å¯ä»¥è‡ªåŠ¨éå†å’Œè§£æç½‘ç«™çš„æ‰€æœ‰ç½‘é¡µï¼Œå¹¶ä¸”é€šè¿‡å•ä¸ªå‘½ä»¤ä¸€æ¬¡æ€§æå–æ‰€æœ‰æ•°æ®ï¼Œä¹Ÿå¯ä»¥å¯¹æ•°æ®è¿›è¡Œçˆ¬å–ã€æ£€ç´¢å’Œè§£æã€‚
å®ƒçš„å·¥ä½œæ–¹å¼æ˜¯æ¢ç´¢ç½‘ç«™çš„HTMLç»“æ„ï¼ŒåŒ…æ‹¬å†…éƒ¨å’Œå¤–éƒ¨é“¾æ¥ã€‚

åƒæˆ‘ä»¬ä¹‹å‰è¯´çš„é‚£æ ·ï¼Œ`RSelenium`å’Œ`Rcrawler`æ˜¯æ¯”è¾ƒè¿›é˜¶çš„æ–¹æ³•ï¼Œæœ‰ä»–ä»¬é’ˆå¯¹çš„ç‹¬ç‰¹çš„é—®é¢˜ï¼Œå°¤å…¶æ˜¯å¯¹äºä¸€äº›å¤æ‚çš„ç½‘ç«™ï¼Œæ¯”å¦‚javaç±»ç½‘ç«™ï¼Œéœ€è¦ç”¨åˆ°ä»–ä»¬å»æŠ“å–ã€‚



### ä½¿ç”¨APIæŠ“å–ç½‘é¡µ

åœ¨å¯èƒ½çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ¨èå°½é‡ä½¿ç”¨ä½¿ç”¨APIè·å–æ•°æ®ï¼Œå› ä¸ºå®ƒé€šå¸¸ä¼šç»™ä½ æä¾›æ›´å¯é çš„æ•°æ®ï¼Œç°åœ¨ç™¾åº¦ã€é«˜å¾·ã€æ¨ç‰¹ï¼ˆXï¼‰ã€æ–°æµªç­‰å¤§ç½‘ç«™å·²ç»æœ‰APIå¯ä»¥å»è·å–æ•°æ®äº†ï¼Œç”šè‡³ï¼Œ**è®¸å¤šæµè¡Œçš„ç½‘ç«™APIå·²ç»æœ‰äº†RåŒ…ï¼**
æ¢å¥è¯è¯´ï¼Œä½ å¯ä»¥ç«‹å³åœ¨Rä¸­ä½¿ç”¨å®ƒï¼

å¦å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨åƒ `httr`å’Œ`jsonlite`è¿™æ ·çš„åŒ…ï¼Œå‘åœ¨çº¿æŠ“å–å·¥å…·ï¼ˆonline scrapperï¼‰ (ä¾‹å¦‚ï¼Œ [Browserbear](https://api.browserbear.com/)ï¼Œ [å…«çˆªé±¼](https://openapi.bazhuayu.com/zh-CN/))ç›´æ¥å‘å‡ºä»»åŠ¡è¯·æ±‚ï¼Œæ–¹ä¾¿å¿«æ·ï¼

ä¾‹å¦‚ï¼Œ [è¿™é‡Œ](https://www.browserbear.com/blog/web-scraping-with-r-an-introduction/)æ˜¯è¿™ç§æ–¹æ³•çš„ä¸€ä¸ªä»‹ç»ã€‚

æ¢å¥è¯è¯´ï¼Œå¦‚æœä½ å‘ç°ä½ éœ€è¦çˆ¬å–çš„ç½‘ç«™ç”¨æœ¬ç« è®²çš„æ–¹æ³•çˆ¬ä¸ä¸‹æ¥ï¼Œå¯ä»¥ç›´æ¥å‘å¤–ç•Œæ±‚åŠ©ã€‚


åœ¨æ¥ä¸‹æ¥çš„æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä¸»è¦å…³æ³¨`rvest`ã€‚
è¿™äº›å†…å®¹ä»Hadley Wickhamã€Mine Ã‡etinkaya-Rundelå’ŒGarrett Grolemundçš„ä¹¦ç±ï¼Œ[*R for Data Science: Import, Tidy, Transform, Visualize, and Model Data*, 2nd edition, O'Reilly Media 2023](https://www.amazon.com/Data-Science-Transform-Visualize-Model/dp/1492097403)ä¸­è·å¾—äº†é‡è¦çµæ„Ÿï¼Œè¿™æ˜¯ä¸€ä¸ªå¼€å‘è·å–çš„ä¹¦ï¼Œå¤§å®¶æœ‰éœ€è¦ä¹Ÿå¯ä»¥å»æŸ¥çœ‹ã€‚

### ä½¿ç”¨`rvest`è¿›è¡Œç½‘é¡µæŠ“å–

åœ¨Rä¸­çˆ¬å–æ•°æ®ä½¿ç”¨æœ€å¤šçš„å°±æ˜¯`rvest`ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹ä»£ç å®‰è£…å¹¶è°ƒç”¨ã€‚

```{r install, eval=FALSE}
if (!require(rvest)) install.packages("rvest")
library("rvest")
```

### æŠ“å–è¿‡ç¨‹

ç½‘é¡µæŠ“å–æ˜¯ä¸€ä¸ª**æ¨¡æ‹Ÿç”¨æˆ·**åœ¨æµè§ˆå™¨æˆ–åº”ç”¨ç¨‹åºä¸Šçš„è¡Œä¸ºä»¥è‡ªåŠ¨åŒ–è¯¥è¿‡ç¨‹çš„è¿‡ç¨‹ï¼š

ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ
æˆ‘ä»¬æµè§ˆç½‘é¡µçš„æ—¶å€™ï¼Œçœ‹ä¼¼åªæ˜¯é¼ æ ‡è½»è½»ä¸€ç‚¹çš„è¿‡ç¨‹ï¼Œä½†æ˜¯å…¶å®è¿™â€œä¸€ç‚¹â€èƒŒåè®¡ç®—æœºå·²ç»å®Œæˆäº†è‡³å°‘äº”ä¸ªæ­¥éª¤çš„å·¥ä½œï¼š

1. è¾“å…¥URLï¼Œæ¯”å¦‚www.amazon.comï¼›
1. æŠŠä¸Šè¿°ç½‘å€è¾“å…¥è§£ææœåŠ¡å™¨DNS Server,æŸ¥æ‰¾ä¸URLåŸŸåå¯¹åº”çš„IPåœ°å€ï¼›
1. å‘å¯¹åº”IPåœ°å€çš„æœåŠ¡å™¨ï¼Œä¸€èˆ¬æ˜¯HTTPæˆ–è€…HTTPSå‘é€**è¯·æ±‚**ï¼ˆrequestï¼‰ï¼›
1. æœåŠ¡å™¨**å“åº”**ï¼ˆresponseï¼‰è¯·æ±‚å¹¶è¿”å›ç½‘é¡µå†…å®¹ï¼›
1. ç”¨æˆ·ç”µè„‘ä¸Šçš„æµè§ˆå™¨**è§£æ**ç½‘é¡µå†…å®¹ã€‚

![](images/scrap_dns.jpg)

ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æµè§ˆç½‘é¡µæ—¶ï¼Œä½ ä½œä¸ºä¸€ä¸ªä¸­è½¬ç«™æ˜¯è¿æ¥äº†ä¸¤æ–¹çš„ï¼Œå®ƒä»¬ä¸­æ— è®ºå“ªä¸ªæ²¡æœ‰è¿æ¥ä¸Šï¼Œæœ€åçš„æ•°æ®éƒ½ä¸ä¼šæ‹¿ä¸‹æ¥ã€‚
å¦‚æœå‰é¢DNSæœåŠ¡å™¨æ²¡è¿æ¥ä¸Šçš„è¯ï¼Œå°±ä¼šå‡ºä¸€ä¸ªä»£ç ï¼Œæ¯”å¦‚æœ€è‘—åçš„404ï¼Œè¯´ä½ è¿™ä¸ªç½‘é¡µæ‰“ä¸å¼€ã€‚
æ‰€ä»¥å…³äºç½‘é¡µèƒ½ä¸èƒ½æ‰“å¼€è¿™ä»¶äº‹ä¸€èˆ¬å…³ç³»åˆ°DNS Serverï¼Œæ‰€ä»¥æœ‰æ—¶å€™å¦‚æœæˆ‘ä»¬ç”¨Ræˆ–è€…æ˜¯ç”¨pythonå»æ‰“å¼€ç½‘ç«™çš„æ—¶å€™ï¼Œå‘ç°æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸Šæ‰“å¾—å¼€ï¼Œä½†ä½ ç”¨Rå»æ‰“å®ƒå°±æ‰“ä¸å¼€äº†ï¼Œå› ä¸ºRå’Œpythonæ˜¯æœºå™¨å‘é€è¯·æ±‚ï¼Œè¿™ä¸ªæ—¶å€™å¯èƒ½å°±è¦åšä¸€äº›è®¤è¯ã€‚

### URL 

æˆ‘ä»¬è¿™é‡Œç»™å¤§å®¶ç®€å•è®²è§£ä¸€ä¸‹urlï¼Œä¹Ÿå°±æ˜¯é“¾æ¥ï¼Œæ˜¯æ€ä¹ˆç»„æˆçš„ã€‚
urlåŸºæœ¬ä¸Šåˆ†æˆä¸‹å›¾è¿™å‡ ä¸ªéƒ¨åˆ†ï¼š

- `schema`: ä¾‹å¦‚ï¼Œhttpï¼Œhttpsï¼Œftpï¼Œsftp
- `host`: æ³¨å†Œåï¼ˆåŒ…æ‹¬ä½†ä¸é™äºä¸»æœºåä¾‹å¦‚wwwï¼‰æˆ–IPåœ°å€ï¼ˆä¸€èˆ¬æ˜¯ä¸€ä¸²æ•°å­—ï¼Œå¦‚ç¤ºä¾‹3ï¼‰
- `port`: å¦‚æœæ˜¯IPåœ°å€åˆ™éœ€è¦ç»™å‡ºportï¼Œä¹Ÿå°±æ˜¯ç¤ºä¾‹3`:`åé¢çš„æ•°å­—59837
- `path`: ç”±æ–œæ ï¼ˆ/ï¼‰åˆ†éš”çš„è·¯å¾„æ®µåºåˆ—

> ç¤ºä¾‹1ï¼šhttps://www.google.com/       
> ç¤ºä¾‹2ï¼šhttps://sammo3182.github.io     
> ç¤ºä¾‹3ï¼šhttp://166.111.105.34:59837/

![](images/scrap_url.png)
