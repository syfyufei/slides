<!DOCTYPE html>
<html lang="en"><head>
<script src="Loop_files/libs/clipboard/clipboard.min.js"></script>
<script src="Loop_files/libs/quarto-html/tabby.min.js"></script>
<script src="Loop_files/libs/quarto-html/popper.min.js"></script>
<script src="Loop_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="Loop_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Loop_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="Loop_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="Loop_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.552">

  <meta name="author" content="SUN Yufei（Adrian）">
  <title>Loop in R</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="Loop_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="Loop_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="Loop_files/libs/revealjs/dist/theme/quarto.css">
  <link rel="stylesheet" href="https://drhuyue.site:10002/Adrian/data/style_basic.css">
  <link href="Loop_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="Loop_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="Loop_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="Loop_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="Loop_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="Loop_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="https://adriansun.drhuyue.site/img/logo.jpg" data-background-position="top 10% right 5%" data-background-size="100px" class="quarto-title-block center">
  <h1 class="title">Loop in R</h1>
  <p class="subtitle">R Workshop 2024 in UTokyo</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
SUN Yufei（Adrian） 
</div>
        <p class="quarto-title-affiliation">
            UTokyo &amp; Tsinghua University
          </p>
    </div>
</div>

</section>
<section>
<section id="course-homepage" class="title-slide slide level1 center" data-background="#43464B">
<h1>Course Homepage</h1>
<div style="text-align: right; margin-top: 1em">
<p>https://adriansun.drhuyue.site/course/r-workshop-tokyo-2024.html</p>
<p>Email: sunyf20@mails.tsinghua.edu.cn</p>
<p><img data-src="https://drhuyue.site:10002/Adrian/figure/qrcode_adriansun.drhuyue.site.png" height="250"></p>
</div>
</section>
<section id="why-we-need-loops" class="slide level2">
<h2>Why we need loops?</h2>
<blockquote>
<p>“Please collect all the news from the ISS website.”</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a><span class="fu">library</span>(rvest)</span>
<span id="cb1-2"><a href=""></a></span>
<span id="cb1-3"><a href=""></a>ISS_news <span class="ot">&lt;-</span> <span class="fu">read_html</span>(<span class="st">"https://issnews.iss.u-tokyo.ac.jp/cat2/cat14/index.html"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-4"><a href=""></a>  <span class="fu">html_nodes</span>(<span class="st">"h3 a"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-5"><a href=""></a>  <span class="fu">html_attr</span>(<span class="st">"href"</span>)</span>
<span id="cb1-6"><a href=""></a></span>
<span id="cb1-7"><a href=""></a><span class="co"># for each page, we need to:</span></span>
<span id="cb1-8"><a href=""></a><span class="co"># 1. read the html</span></span>
<span id="cb1-9"><a href=""></a><span class="co"># 2. extract the news</span></span>
<span id="cb1-10"><a href=""></a><span class="co"># 3. combine them together</span></span>
<span id="cb1-11"><a href=""></a></span>
<span id="cb1-12"><a href=""></a>first_page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(ISS_news[<span class="dv">1</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb1-13"><a href=""></a>  <span class="fu">html_nodes</span>(<span class="st">"p:nth-child(2)"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-14"><a href=""></a>  <span class="fu">html_text</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If we don’t use loops, we need to manually collect the news from each page. That will be 3*PageNum lines of code.</p>
<aside class="notes">
<p>Now let image a situation where we need to collect news from ISS website.</p>
<p>If we don’t use loops, we need to manually collect the news from each page. That will be 3*PageNum lines of code.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="why-we-need-loops-1" class="slide level2">
<h2>Why we need loops?</h2>
<ul>
<li class="fragment"><p><strong>Reduces Code Repetition</strong></p></li>
<li class="fragment"><p><strong>Superior Efficiency</strong></p></li>
<li class="fragment"><p><strong>Saves Time</strong></p></li>
</ul>
<aside class="notes">
<p>Think of loops as a treadmill in the programming world. You simply place repetitive tasks on it, press “start”, and it will help you complete them over and over until you tell it “enough”. This way, you don’t have to manually repeat the same work, and you can keep your code clean and elegant.</p>
<p>Using loops offers several advantages:</p>
<ul>
<li>Reduces Code Repetition: Individual commands are like hand-washing clothes, while loops are like programming washing machines that automatically complete repetitive work. By using loops, you can avoid rewriting the same code, making programs more concise and easier to maintain.</li>
<li>Superior Efficiency: Imagine if you need to print “Hello, World!” 100 times - would you manually input these 100 lines of code? Using loops, you only need to write the print statement once and tell the loop to execute it 100 times. This not only saves considerable time but also reduces the possibility of errors.</li>
<li>Saves Time: Loops are like superheroes that can complete tasks at high speed, making your code run faster and more efficiently.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="key-concepts" class="slide level2">
<h2>Key Concepts</h2>
<ul>
<li class="fragment">Research Question: <strong>Is social trust, an important component of social capital, affected by social inequality?</strong>
<ul>
<li class="fragment">How to create a “neighborhood distrust” variable based on neighborhood trust variables?</li>
<li class="fragment">How to categorize income levels into low, medium, and high based on family income?</li>
</ul></li>
<li class="fragment">Loops
<ul>
<li class="fragment">Conditional Statements</li>
<li class="fragment">Iteration</li>
<li class="fragment">While Loops</li>
<li class="fragment">Repeat Loops</li>
</ul></li>
</ul>
</section>
<section id="loops" class="slide level2">
<h2>Loops</h2>
<p>Loops are <em>conditional</em> repetitions.</p>

<img data-src="https://drhuyue.site:10002/Adrian/figure/loopDiagrams.png" style="width:100.0%" class="r-stretch"><aside class="notes">
<p>Loops are <em>conditional</em> repetitions. Using loops can effectively reduce the occurrence of the same or similar commands multiple times, decrease errors caused by manually writing statements repeatedly, and enhance the readability and efficiency of programming. This section introduces a basic conditional statement and the three most commonly used loop statements in social science data processing and analysis.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="conditional-statements-if" class="slide level2">
<h2>Conditional Statements (IF)</h2>
<p>Conditional statements are not loop statements but are the foundation of loop statements. They determine whether the loop continues. Almost all loop statements can be broken down into finite steps of conditional statements.</p>

<img data-src="https://drhuyue.site:10002/Adrian/figure/ifDiagram.png" style="width:100.0%" class="r-stretch"><h3 id="logical-judgement">Logical Judgement</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href=""></a><span class="dv">1</span> <span class="sc">+</span> <span class="dv">1</span> <span class="sc">!=</span> <span class="dv">2</span></span>
<span id="cb2-2"><a href=""></a></span>
<span id="cb2-3"><a href=""></a><span class="fu">is.na</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="cn">NA</span>, <span class="dv">3</span>))</span>
<span id="cb2-4"><a href=""></a></span>
<span id="cb2-5"><a href=""></a><span class="fu">is.numeric</span>(wvs7<span class="sc">$</span>female)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside class="notes">
<ul>
<li><p>TRUE == 1, FALSE == 0</p></li>
<li><p>As we learned in <strong>?@sec-algebra</strong>, <code>!=</code> means “not equal to,” so <code>1 + 1 != 2</code> means “1 plus 1 is not equal to 2,” which is obviously incorrect, resulting in <code>FALSE</code>.</p></li>
<li><p>The <code>is.na()</code> function checks each element of a vector, returning <code>TRUE</code> if the element is missing (NA) and <code>FALSE</code> otherwise. Thus, <code>is.na(c(1, 2, NA, 3))</code> results in a logical vector: <code>FALSE, FALSE, TRUE, FALSE</code>, indicating only the third element is missing.</p></li>
<li><p><code>is.numeric()</code> checks if the given object is of numeric type, returning <code>TRUE</code> if it is, and <code>FALSE</code> otherwise. <code>is.numeric(wvs7$female)</code> checks if the <code>female</code> column in the <code>wvs7</code> data frame is numeric.</p></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="conditional-handling" class="slide level2">
<h2>Conditional Handling</h2>
<ul>
<li class="fragment">If…then, else…then… is a form of conditional statement used in almost all high-level programming languages.
<ul>
<li class="fragment">Basic Syntax: <code>if(&lt;logical condition&gt;){&lt;execute command&gt;}</code></li>
<li class="fragment">Extended Syntax: <code>if(&lt;logical condition1&gt;){&lt;execute command1&gt;} else if(&lt;logical condition2&gt;){&lt;execute command2&gt;}... else(&lt;execute commandn&gt;)</code>
<ul>
<li class="fragment">Statement Vectorization: <code>ifelse(&lt;logical condition&gt;, &lt;execute command1&gt;, &lt;execute command2&gt;)</code></li>
<li class="fragment">Multi-condition Abbreviation: <code>case_when(&lt;logical condition1&gt; ~ &lt;execute command1&gt;, &lt;logical condition2&gt; ~ &lt;execute command2&gt;, ...)</code></li>
</ul></li>
</ul></li>
</ul>
<aside class="notes">
<ul>
<li><code>ifelse()</code> is a vectorized version of <code>if...then...</code> that applies the same logic to each element of a vector.</li>
<li><code>ifelse()</code> is a vectorized version of <code>if...then...</code> that applies the same logic to each element of a vector.</li>
<li><code>case_when()</code> is a more flexible version of <code>if...then...</code> that allows for multiple conditions and corresponding actions.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<ul>
<li class="fragment">e.g., Convert the gender variable in <code>wvs7</code> to a numeric variable if it is logical</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href=""></a><span class="cf">if</span>(<span class="fu">is.logical</span>(wvs7<span class="sc">$</span>female)) wvs7<span class="sc">$</span>female <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(wvs7<span class="sc">$</span>female)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li class="fragment">e.g., Create a “neighborhood distrust” variable based on the neighborhood trust variable in <code>wvs7</code>, where 4 represents the least trust and 1 represents the most trust</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href=""></a><span class="cf">if</span>(wvs7<span class="sc">$</span>trust_neighbor[<span class="dv">1</span>] <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb4-2"><a href=""></a>  wvs7<span class="sc">$</span>distrust_neighbor[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb4-3"><a href=""></a>} <span class="cf">else</span> <span class="cf">if</span> (wvs7<span class="sc">$</span>trust_neighbor[<span class="dv">1</span>] <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb4-4"><a href=""></a>  wvs7<span class="sc">$</span>distrust_neighbor[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb4-5"><a href=""></a>} <span class="cf">else</span> <span class="cf">if</span> (wvs7<span class="sc">$</span>trust_neighbor[<span class="dv">1</span>] <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb4-6"><a href=""></a>  wvs7<span class="sc">$</span>distrust_neighbor[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb4-7"><a href=""></a>} <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">is.na</span>(wvs7<span class="sc">$</span>trust_neighbor[<span class="dv">1</span>])) {</span>
<span id="cb4-8"><a href=""></a>  wvs7<span class="sc">$</span>distrust_neighbor[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb4-9"><a href=""></a>} <span class="cf">else</span>{</span>
<span id="cb4-10"><a href=""></a>  wvs7<span class="sc">$</span>distrust_neighbor[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb4-11"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside class="notes">
<p>The code above only converts the first observation of the <code>trust_neighbor</code> variable in the <code>wvs7</code> dataset. If we want to create a corresponding <code>distrust_neighbor</code> variable for the entire <code>trust_neighbor</code> variable, we need to use a looping approach.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<ul>
<li class="fragment">What is wrong with the following approach?</li>
</ul>
<aside class="notes">
<ul>
<li>When the neighborhood trust variable <code>trust_neighbor</code> is 1, the neighborhood distrust variable <code>distrust_neighbor</code> should be assigned a value of 4.</li>
<li>But if you run this code under console, will you get the desired result?</li>
</ul>
<p>The errors in this code are in. 1. Logic error: this code will only judge and assign a value to the first line in the dataframe wvs7. If the first element of <code>wvs7$trust_neighbor</code> is equal to 1, then the first element of <code>wvs7$distrust_neighbor</code> is assigned a value of 4. This does not do anything to the other rows in wvs7. 2. incomplete conditional judgment. 2. Incomplete conditional judgment: If your intent is to set <code>wvs7$distrust_neighbor</code> to 4 for all elements of <code>wvs7$trust_neighbor</code> that are equal to 1, then you should use a vectorized conditional judgment rather than operate on the first row alone.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<aside class="notes">
<p>The correct approach is to use the <code>ifelse</code> function, which conditions the vector element by element. Set the value of the <code>distrust_neighbor</code> column in the row corresponding to the <code>trust_neighbor</code> column equal to 1 in the <code>wvs7</code> dataframe to 4, leaving the values of the other rows unchanged.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<ul>
<li class="fragment">Does this approach solve my problem?</li>
</ul>
<aside class="notes">
<p>We just learned about using <code>ifelse</code>, wouldn’t it work if we used <code>ifelse</code> to assign values to <code>distrust_neighbor</code> based on the value of each <code>trust_neighbor</code>? Might as well try running this code:</p>
<p>The above command still gives an error (<code>replacement has length zero</code>), but don’t be discouraged. By looking at the structure of <code>wvs7$trust_neighbor</code>, it turns out that <code>wvs7$trust_neighbor</code> exists as a <code>NA</code></p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<aside class="notes">
<p>Finally it’s right!</p>
<p>But this code is still too long and not concise enough.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<ul>
<li class="fragment">Is there a better way?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href=""></a>wvs7<span class="sc">$</span>distrust_neighbor <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">-</span> wvs7<span class="sc">$</span>trust_neighbor</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside class="notes">
<p>We also need to think reversely when writing code. The values ​​of <code>wvs7$trust_neighbor</code> are 1, 2, 3, 4, NA. If we want to create <code>wvs7$distrust_neighbor</code>, we can just subtract it from 5! Isn’t it amazing!</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<ul>
<li class="fragment">e.g.: According to the household income level in <code>wvs7</code>, low (1), medium (2), high (3) and other levels are distinguished. The distinction standards are the 25% and 75% quantile points.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href=""></a>vec_cut <span class="ot">&lt;-</span> <span class="fu">quantile</span>(wvs7<span class="sc">$</span>incomeLevel, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-2"><a href=""></a>wvs7<span class="sc">$</span>incomeCat3 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(wvs7<span class="sc">$</span>incomeLevel <span class="sc">&lt;</span> vec_cut[<span class="dv">1</span>], <span class="dv">1</span>,</span>
<span id="cb6-3"><a href=""></a><span class="fu">ifelse</span>(wvs7<span class="sc">$</span>incomeLevel <span class="sc">&gt;</span> vec_cut[<span class="dv">2</span>], <span class="dv">3</span>,</span>
<span id="cb6-4"><a href=""></a><span class="fu">ifelse</span>(<span class="fu">is.na</span>(wvs7<span class="sc">$</span>incomeLevel), <span class="cn">NA</span>, <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside class="notes">
<p>This line of code uses the <code>quantile</code> function to calculate the 25% and 75% quantiles of <code>incomeLevel</code> and stores the results in <code>vec_cut</code>. The <code>na.rm = TRUE</code> parameter ensures that missing values ​​are ignored when calculating quantiles. The second piece of code uses a nested <code>ifelse</code> function to assign a classification level to each observation: - If <code>incomeLevel</code> is less than the 25% percentile (<code>vec_cut[1]</code>), <code>incomeCat3</code> is assigned a value of 1 (low income). - If <code>incomeLevel</code> is greater than the 75% percentile (<code>vec_cut[2]</code>), <code>incomeCat3</code> is assigned a value of 3 (high income). - If <code>incomeLevel</code> is between the 25th and 75th percentiles, <code>incomeCat3</code> is assigned a value of 2 (middle income). - If <code>incomeLevel</code> is a missing value, <code>incomeCat3</code> is also assigned the value NA.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href=""></a>wvs7<span class="sc">$</span>incomeCat3 <span class="ot">&lt;-</span> <span class="fu">case_when</span>(</span>
<span id="cb7-2"><a href=""></a>wvs7<span class="sc">$</span>incomeLevel <span class="sc">&lt;</span> vec_cut[<span class="dv">1</span>] <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb7-3"><a href=""></a>wvs7<span class="sc">$</span>incomeLevel <span class="sc">&gt;=</span> vec_cut[<span class="dv">1</span>] <span class="sc">&amp;</span> wvs7<span class="sc">$</span>incomeLevel <span class="sc">&lt;=</span> vec_cut[<span class="dv">2</span>] <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb7-4"><a href=""></a>wvs7<span class="sc">$</span>incomeLevel <span class="sc">&gt;</span> vec_cut[<span class="dv">2</span>] <span class="sc">~</span> <span class="dv">3</span></span>
<span id="cb7-5"><a href=""></a>)</span>
<span id="cb7-6"><a href=""></a><span class="co"># If no condition is met, case_when directly assigns NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside class="notes">
<p>This code uses the <code>case_when</code> function to assign a classification level to each observation: - When <code>incomeLevel</code> is less than the 25% percentile (<code>vec_cut[1]</code>), <code>incomeCat3</code> is assigned a value of 1 (low income). - When <code>incomeLevel</code> is greater than the 75% percentile (<code>vec_cut[2]</code>), <code>incomeCat3</code> is assigned a value of 3 (high income). - For other cases (i.e.&nbsp;<code>incomeLevel</code> is between the 25th and 75th percentiles), <code>incomeCat3</code> is assigned a value of 2 (middle income). This is achieved through <code>TRUE ~ 2</code>, where TRUE is equivalent to a default condition, which will match all situations not covered by the previous condition. <strong>The advantage of using <code>case_when</code> is that it can make the correspondence between conditions and results more clear</strong>, while also avoiding the complexity that may be caused by nested <code>ifelse</code> functions.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<ul>
<li class="fragment">What if I want to do it by country?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href=""></a>vec_cut <span class="ot">&lt;-</span> <span class="fu">quantile</span>(wvs7<span class="sc">$</span>incomeLevel, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-2"><a href=""></a>wvs7 <span class="ot">&lt;-</span> <span class="fu">group_by</span>(wvs7, country) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href=""></a><span class="fu">mutate</span>(<span class="at">incomeCat3 =</span> <span class="fu">case_when</span>(</span>
<span id="cb8-4"><a href=""></a>incomeLevel <span class="sc">&lt;</span> vec_cut[<span class="dv">1</span>] <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb8-5"><a href=""></a>incomeLevel <span class="sc">&gt;=</span> vec_cut[<span class="dv">1</span>] <span class="sc">&amp;</span> incomeLevel <span class="sc">&lt;=</span> vec_cut[<span class="dv">2</span>] <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb8-6"><a href=""></a>incomeLevel <span class="sc">&gt;</span> vec_cut[<span class="dv">2</span>] <span class="sc">~</span> <span class="dv">3</span></span>
<span id="cb8-7"><a href=""></a>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside class="notes">
<p>This code uses the <code>group_by</code> function to group the <code>wvs7</code> data set by the country` column.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="traversal-for" class="slide level2">
<h2>Traversal (FOR)</h2>

<img data-src="https://drhuyue.site:10002/Adrian/figure/loop/forDiagram.png" style="width:100.0%" class="r-stretch"><p>Command syntax: <code>for(&lt;index&gt; in &lt;input sequence&gt;){&lt;execution command&gt;}</code> Enter sequence settings: - given value range - Determined by variables and data frame dimensions</p>
<aside class="notes">
<p>The traversal loop means that the user gives the input sequence, the program sequentially takes values, and performs “exhaustion judgment”, that is, whether all values ​​in the input value sequence have been taken. If it is judged to be “no”, use the value to perform the preset command. If it is “yes”, stop the command. Different from the judgment statement, the input here is a sequence of values ​​rather than a single value, and the purpose of program operation has also changed from a single judgment-output to <em>repeated</em> running of commands within a given value range. Traversal loops are the most common type of loop, and they also form the basic operating logic of program batch processing in subsequent chapters. Logic diagram of traversing loop statements:</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="traversal-loop" class="slide level2">
<h2>Traversal Loop</h2>
<ul>
<li class="fragment">e.g., establish the “neighborhood distrust” variable based on the neighborhood trust variable in <code>wvs7</code>, 4 represents the least trust, 1 represents the most trust</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href=""></a><span class="fu">length</span>(wvs7<span class="sc">$</span>trust_neighbor)</span>
<span id="cb9-2"><a href=""></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1264</span>) {</span>
<span id="cb9-3"><a href=""></a><span class="cf">if</span> (<span class="fu">is.na</span>(wvs7<span class="sc">$</span>trust_neighbor[i])) {</span>
<span id="cb9-4"><a href=""></a>wvs7<span class="sc">$</span>distrust_neighbor[i] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb9-5"><a href=""></a>} <span class="cf">else</span> <span class="cf">if</span> (wvs7<span class="sc">$</span>trust_neighbor[i] <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb9-6"><a href=""></a>wvs7<span class="sc">$</span>distrust_neighbor[i] <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb9-7"><a href=""></a>} <span class="cf">else</span> <span class="cf">if</span> (wvs7<span class="sc">$</span>trust_neighbor[i] <span class="sc">==</span> <span class="dv">2</span>) {</span>
<span id="cb9-8"><a href=""></a>wvs7<span class="sc">$</span>distrust_neighbor[i] <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb9-9"><a href=""></a>} <span class="cf">else</span> <span class="cf">if</span> (wvs7<span class="sc">$</span>trust_neighbor[i] <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb9-10"><a href=""></a>wvs7<span class="sc">$</span>distrust_neighbor[i] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb9-11"><a href=""></a>} <span class="cf">else</span>{</span>
<span id="cb9-12"><a href=""></a>wvs7<span class="sc">$</span>distrust_neighbor[i] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb9-13"><a href=""></a>}</span>
<span id="cb9-14"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside class="notes">
<p>Previously, because the <code>if</code> judgment statement could only receive a single logical judgment, I could only apply logical judgment to a single value in <code>wvs7$trust_neighbor</code> to obtain the value. If I want to perform a replacement operation on each value, or write out the coordinates of each value (<code>wvs7$trust_neighbor[1]</code>, <code>wvs7$trust_neighbor[2]</code>, <code>wvs7$trust_neighbor[3]</code>…) and then repeat the following commands, or use the <code>ifelse</code> command to perform vectorization operations. However, the vectorization operation is not applicable all the time (for example, <code>ifelse</code> can only return a vector value with the same length as the input sequence. If the execution command contains multiple output values, it cannot be implemented through <code>ifelse</code>). At this time, I can use a traversal loop statement to complete this task:</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<p>For the output object, it can be determined according to the purpose of the command; for the input value range, dynamic assignment can also be used.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href=""></a>ls_tb <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"list"</span>)</span>
<span id="cb10-2"><a href=""></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq</span>(wvs7_trust)) {</span>
<span id="cb10-3"><a href=""></a>ls_tb[[i]] <span class="ot">&lt;-</span> <span class="fu">pull</span>(wvs7_trust, i) <span class="sc">%&gt;%</span> table</span>
<span id="cb10-4"><a href=""></a>}</span>
<span id="cb10-5"><a href=""></a><span class="fu">names</span>(ls_tb) <span class="ot">&lt;-</span> <span class="fu">names</span>(wvs7_trust)</span>
<span id="cb10-6"><a href=""></a>ls_tb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="build-a-recursive-loop" class="slide level2">
<h2>Build a recursive loop</h2>
<ul>
<li class="fragment">e.g., calculate how many numeric variables there are in <code>wvs7</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href=""></a>count_num <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb11-2"><a href=""></a><span class="cf">for</span> (variable <span class="cf">in</span> <span class="fu">names</span>(wvs7)) {</span>
<span id="cb11-3"><a href=""></a><span class="cf">if</span> (<span class="fu">is.numeric</span>(wvs7[[variable]])) {</span>
<span id="cb11-4"><a href=""></a>count_num <span class="ot">&lt;-</span> count_num <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb11-5"><a href=""></a>}</span>
<span id="cb11-6"><a href=""></a>}</span>
<span id="cb11-7"><a href=""></a>count_num</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside class="notes">
<ul>
<li><code>count_num &lt;- 0</code>: This line of code initializes a counter, setting it to zero.</li>
<li><code>for (variable in names(wvs7)) { ... }</code>: This loop iterates through all column names in the data frame <code>wvs7</code>.</li>
<li><code>if (is.numeric(wvs7[[variable]])) { ... }</code>: Inside the loop, this <code>if</code> statement checks whether the currently traversed column is numeric.</li>
<li><code>count_num &lt;- count_num + 1</code>: If the column is numeric, the counter will be incremented by 1.</li>
<li>After the loop ends, <code>count_num</code> will contain the total number of numeric variables in the data frame.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="condition-loop-while" class="slide level2">
<h2>Condition Loop (WHILE)</h2>
<p>The purpose of conditional loops is to repeatedly run commands. Logic diagram of conditional loop statement:</p>

<img data-src="https://drhuyue.site:10002/Adrian/figure/loop/whileDiagram.png" style="width:100.0%" class="r-stretch"><aside class="notes">
<p>The main difference from the traversal loop is that the conditional loop does not terminate based on whether all index values ​​​​are traversed, but whether a given condition is reached. Therefore, it is more convenient when the number of indexes is unknown. Of course, if the termination condition is set to traverse all index values, the conditional loop and the traversal loop will have the same effect. In fact, all iteration loops can be rewritten as conditional loops, but not vice versa. Therefore, conditional loops are actually a more <em>comprehensive</em> form of loop statements than traversal loops.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<ul>
<li class="fragment">e.g.&nbsp;A rewrite of the previous contingency table example</li>
</ul>
<p>Previous example of using <code>for</code>:</p>
<p>Rewrite using <code>while</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href=""></a>ls_tb2 <span class="ot">&lt;-</span><span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"list"</span>)</span>
<span id="cb12-2"><a href=""></a>j <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb12-3"><a href=""></a><span class="cf">while</span>(j <span class="sc">&lt;=</span> <span class="fu">length</span>(wvs7_trust)) {</span>
<span id="cb12-4"><a href=""></a>ls_tb2[[j]] <span class="ot">&lt;-</span> <span class="fu">pull</span>(wvs7_trust, j) <span class="sc">%&gt;%</span> table</span>
<span id="cb12-5"><a href=""></a>j <span class="ot">&lt;-</span> j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb12-6"><a href=""></a>}</span>
<span id="cb12-7"><a href=""></a><span class="fu">names</span>(ls_tb2) <span class="ot">&lt;-</span> <span class="fu">names</span>(wvs7_trust)</span>
<span id="cb12-8"><a href=""></a>ls_tb2</span>
<span id="cb12-9"><a href=""></a><span class="fu">identical</span>(ls_tb, ls_tb2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="condition-loop-while-1" class="slide level2">
<h2>Condition Loop (WHILE)</h2>
<p>Conversely, not all conditional loop statements can be rewritten as traversal loops.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href=""></a>i <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb13-2"><a href=""></a><span class="cf">while</span> (<span class="cn">TRUE</span>) {</span>
<span id="cb13-3"><a href=""></a><span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> <span class="fl">0.01</span>)</span>
<span id="cb13-4"><a href=""></a><span class="cf">break</span></span>
<span id="cb13-5"><a href=""></a>i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb13-6"><a href=""></a>}</span>
<span id="cb13-7"><a href=""></a>i</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This type of statement cannot be rewritten into a traversal loop statement, but R also provides a shorthand mode, which is a repeated statement.</p>
<aside class="notes">
<p>Especially when only the termination condition is clear, but the number of command runs or the index is uncertain, the conditional loop cannot be rewritten into a traversal loop. This example is particularly likely to occur in cases involving random numbers: For example, we use uniform distribution as a random variable equation to count and accumulate, and add 1 every time a random number is generated. It is stipulated that counting can only be stopped when the generated random number is less than 0.01. This kind of running program can only be achieved using conditional loops:</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="repeating-loop-repeat" class="slide level2">
<h2>Repeating Loop (REPEAT)</h2>
<p>Repeating loop statements can be viewed as conditional loops with “continue running” as the termination condition.</p>

<img data-src="https://drhuyue.site:10002/Adrian/figure/loop/repeatDiagram.png" style="width:100.0%" class="r-stretch"><aside class="notes">
<p>This special form of conditional loops is more common when creating command constructs that operate on unknown data, and is less commonly used alone than traversals and conditional loops. Terminating the repeating loop needs to be done through a judgment statement after running the command. Logic diagram of repeated loop statement:</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="repeating-loop-repeat-1" class="slide level2">
<h2>Repeating Loop (REPEAT)</h2>
<p>Let’s rewrite the following example of the conditional statement above using a repeated statement:</p>
<p>Example using <code>while</code>:</p>
<p>Use <code>repeat</code> to rewrite:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href=""></a><span class="cf">repeat</span>{</span>
<span id="cb14-2"><a href=""></a><span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> <span class="fl">0.01</span>)</span>
<span id="cb14-3"><a href=""></a><span class="cf">break</span></span>
<span id="cb14-4"><a href=""></a>i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb14-5"><a href=""></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside class="notes">
<p>First piece of code (using <code>while</code> loop): - <code>i &lt;- 0</code>: Initialize counter i to 0. - <code>while (TRUE) { ... }</code>: Use an infinite loop, the loop will continue until a <code>break</code> statement is encountered. - <code>if (runif(1) &lt; 0.01) break</code>: In each loop, generate a random number between 0 and 1. If this random number is less than 0.01, use the break statement to break out of the loop. - <code>i &lt;- i + 1</code>: If the loop is not broken out, counter i is increased by 1. - <code>i</code>: After the loop ends, the value of counter i is output, indicating how many times the loop has been executed. Second piece of code (using <code>repeat</code> loop): - <code>repeat { ... }</code>: Use <code>repeat</code> loop, which is also an infinite loop and will not stop until it encounters <code>break</code> statement.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<p>Another example of a conditional loop can also be rewritten as a repeated loop.</p>
<p>Example using <code>while</code>:</p>
<p>Use <code>repeat</code> to rewrite:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href=""></a>k<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb15-2"><a href=""></a><span class="cf">repeat</span>{</span>
<span id="cb15-3"><a href=""></a>ls_tb3[[k]] <span class="ot">&lt;-</span> <span class="fu">pull</span>(wvs7_trust, k) <span class="sc">%&gt;%</span> table</span>
<span id="cb15-4"><a href=""></a>k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb15-5"><a href=""></a><span class="cf">if</span>(k <span class="sc">==</span> <span class="fu">length</span>(wvs7_trust) <span class="sc">+</span> <span class="dv">1</span>) <span class="cf">break</span></span>
<span id="cb15-6"><a href=""></a>}</span>
<span id="cb15-7"><a href=""></a><span class="fu">names</span>(ls_tb3) <span class="ot">&lt;-</span> <span class="fu">names</span>(wvs7_trust)</span>
<span id="cb15-8"><a href=""></a><span class="fu">identical</span>(ls_tb2, ls_tb3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside class="notes">
<ul>
<li><code>ls_tb3[[k]] &lt;- pull(wvs7_trust, k) %&gt;% table</code>: In each loop, use the <code>pull()</code> function to extract the data of the <code>k</code>th column in the data frame <code>wvs7_trust</code>, Then use the <code>table()</code> function to calculate the frequency table of the column data and store the result in the <code>k</code>th element of the list <code>ls_tb3</code>.</li>
<li><code>if(k == length(wvs7_trust) + 1) break</code>: If the value of counter k is equal to the number of columns of data frame <code>wvs7_trust</code> plus 1, use the <code>break</code> statement to break out of the loop.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<div class="quarto-auto-generated-content">
<p><img src="https://gitlab.com/sammo3182/backup/raw/85b3c1ad4b459d7a9f901f124b936428eda5fcaf/logo_zzxx.png?inline=true" class="slide-logo"></p>
<div class="footer footer-default">
<p>SUN Yufei（Adrian）</p>
</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="Loop_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="Loop_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="Loop_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="Loop_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="Loop_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="Loop_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="Loop_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="Loop_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="Loop_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="Loop_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="Loop_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: true,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1600,

        height: 900,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
              // target, if specified
              link.setAttribute("target", "_blank");
              if (link.getAttribute("rel") === null) {
                link.setAttribute("rel", "noopener");
              }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>